import{a as pe,d as V,u as xe,j as ee,L as d,r as C,o as r,c as u,b as e,e as c,w as $,f as g,g as o,R as j,h as N,i as L,t as v,p as W,k as J,S as Se,F as x,l as Ce,m as be,s as T,n as re,q as A,v as de,x as D,y as U,z as B,A as G,B as X,C as Qe,M as ue,D as ye,E as ke,G as _e,H as he,I as ve,J as z,K as ge,N as te,O as se,_ as ne,P as oe,Q as ae,T as ie,U as Ee,V as Le,W as Oe,X as Ie,Y as Te,Z as Re,$ as Ae,a0 as Pe,a1 as De,a2 as je,a3 as Me,a4 as Ne,a5 as Ke,a6 as Be,a7 as Ue,a8 as Ve,a9 as He,aa as Fe,ab as ze,ac as We,ad as Je,ae as Ye,af as Ge,ag as Xe,ah as Ze,ai as et,aj as tt,ak as st,al as nt,am as ot,an as at,ao as it,ap as rt,aq as ct,ar as lt,as as dt,at as ut,au as _t,av as ht}from"./vendor-8hCdZR-U.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const _ of i)if(_.type==="childList")for(const p of _.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&a(p)}).observe(document,{childList:!0,subtree:!0});function n(i){const _={};return i.integrity&&(_.integrity=i.integrity),i.referrerPolicy&&(_.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?_.credentials="include":i.crossOrigin==="anonymous"?_.credentials="omit":_.credentials="same-origin",_}function a(i){if(i.ep)return;i.ep=!0;const _=n(i);fetch(i.href,_)}})();const E=pe.create({baseURL:"/",headers:{Accept:"application/json","Content-Type":"application/json"}}),R=V("token",{state:()=>({token:xe("token",""),sound:!0}),getters:{refresh_token(){return this.token?ee(this.token).refresh_token:""},eid(){return this.token?ee(this.token).eid:""},id(){return this.token?ee(this.token).user_id:""},is_admin(){return this.token?ee(this.token).is_admin:!1}},actions:{async getToken(){d.info("token:get"),await E.get("/auth/token",{withCredentials:!0}).then(t=>{this.token=t.data.token}).catch(t=>{t.response&&t.response.status===401?(this.token="",d.info("token:get login failed - redirecting to CAS"),window.location.href="/auth/login"):(d.error("token:get error"+t),this.token="")})},async tryToken(){d.info("token:try"),await E.get("/auth/token",{withCredentials:!0}).then(t=>{this.token=t.data.token}).catch(async t=>{t.response&&t.response.status===401?(d.info("token:try login failed - trying refresh token"),await this.tryRefreshToken()):(d.error("token:try error"+t),this.token="")})},async refreshToken(){d.info("token:refresh"),await E.post("/auth/token",{refresh_token:this.refresh_token}).then(t=>{this.token=t.data.token}).catch(t=>{t.response&&t.response.status===401?(this.token="",d.info("token:refresh login failed - redirecting to CAS"),window.location.href="/auth/login"):(d.error("token:refresh error"+t),this.token="")})},async tryRefreshToken(){d.info("token:tryrefresh"),await E.post("/auth/token",{refresh_token:this.refresh_token}).then(t=>{this.token=t.data.token}).catch(t=>{t.response&&t.response.status===401?(this.token="",d.info("token:tryrefresh login failed")):(this.token="",d.error("token:tryrefresh error"+t))})},async logout(){this.token="",window.location.href="/auth/logout"},async toggleSound(){this.sound=!this.sound}}}),K=(t,s)=>{const n=t.__vccOpts||t;for(const[a,i]of s)n[a]=i;return n},ft=t=>(W("data-v-2892401b"),t=t(),J(),t),mt={class:"navbar navbar-expand-md navbar-dark fixed-top bg-purple"},pt={class:"container"},bt=ft(()=>e("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarCollapse","aria-controls":"navbarCollapse","aria-expanded":"false","aria-label":"Toggle navigation"},[e("span",{class:"navbar-toggler-icon"})],-1)),yt={id:"navbarCollapse",class:"collapse navbar-collapse"},kt={class:"navbar-nav me-auto mb-2 mb-md-0"},vt={class:"nav-item"},gt={class:"nav-item"},wt={key:0,class:"nav-item"},$t={key:1,class:"nav-item"},qt={class:""},xt={key:0},St={class:"navbar-nav me-auto mb-2 mb-md-0"},Ct={class:"nav-item"},Qt={class:"nav-item"},Et={class:"nav-item"},Lt={key:1},Ot={__name:"NavBar",setup(t){const s=R();return(n,a)=>{const i=C("font-awesome-icon");return r(),u("nav",mt,[e("div",pt,[c(o(j),{to:"/",class:"navbar-brand"},{default:$(()=>[g("Office Hours")]),_:1}),bt,e("div",yt,[e("ul",kt,[e("li",vt,[c(o(j),{to:"/queues","active-class":"active",class:"nav-link"},{default:$(()=>[g("Queues")]),_:1})]),e("li",gt,[c(o(j),{to:"/about","active-class":"active",class:"nav-link"},{default:$(()=>[g("About")]),_:1})]),o(s).is_admin?(r(),u("li",wt,[c(o(j),{to:"/admin","active-class":"active",class:"nav-link"},{default:$(()=>[g("Admin")]),_:1})])):N("",!0),o(s).is_admin?(r(),u("li",$t,[c(o(j),{to:"/data","active-class":"active",class:"nav-link"},{default:$(()=>[g("Data")]),_:1})])):N("",!0)]),e("div",qt,[o(s).token?(r(),u("div",xt,[e("ul",St,[e("li",Ct,[e("a",{class:"nav-link",onClick:a[0]||(a[0]=(..._)=>o(s).toggleSound&&o(s).toggleSound(..._))},[o(s).sound?(r(),L(i,{key:0,icon:"bell"})):(r(),L(i,{key:1,icon:"bell-slash"}))])]),e("li",Qt,[c(o(j),{to:"/profile","active-class":"active",class:"nav-link"},{default:$(()=>[c(i,{icon:"user"}),g(" "+v(o(s).eid),1)]),_:1})]),e("li",Et,[e("a",{class:"btn btn-success float-end",onClick:a[1]||(a[1]=_=>o(s).logout())},[c(i,{icon:"arrow-right-from-bracket"}),g(" Logout")])])])])):(r(),u("div",Lt,[e("a",{class:"btn btn-success",onClick:a[2]||(a[2]=_=>o(s).getToken())},[c(i,{icon:"arrow-right-to-bracket"}),g(" Login")])]))])])])])}}},It=K(Ot,[["__scopeId","data-v-2892401b"]]),Tt={id:"main",class:"container px-4 py-5"},Rt={__name:"App",setup(t){return R().tryToken(),(n,a)=>(r(),u(x,null,[e("header",null,[c(It)]),e("div",Tt,[(r(),L(Se,null,{default:$(()=>[c(o(Ce))]),_:1}))])],64))}},At=K(Rt,[["__scopeId","data-v-afa63203"]]),Pt={},Dt=t=>(W("data-v-e8e73fd2"),t=t(),J(),t),jt={class:"pb-2 border-bottom"},Mt=Dt(()=>e("div",{class:"row p-4 pb-0 pt-lg-4 pb-lg-4 align-items-center rounded-3 border shadow-lg"},[e("div",{class:"col-lg-10 mx-auto"},[e("p",{class:"lead-custom text-center"},[g(" Welcome! This site manages virtual queues for office hours."),e("br"),g("Let's get started! ")])])],-1));function Nt(t,s){const n=C("font-awesome-icon");return r(),u(x,null,[e("h2",jt,[c(n,{icon:"chalkboard-teacher"}),g(" Office Hours Queue ")]),Mt],64)}const Kt=K(Pt,[["render",Nt],["__scopeId","data-v-e8e73fd2"]]),Bt=e("br",null,null,-1),Ut={key:0},Vt={key:1},Ht={__name:"LoginMessage",setup(t){const s=R();return(n,a)=>{const i=C("RouterLink"),_=C("font-awesome-icon");return r(),u("main",null,[c(Kt),Bt,o(s).token?(r(),u("div",Ut,[c(i,{to:"/queues",class:"btn btn-success"},{default:$(()=>[g("Click Here to See Available Queues")]),_:1})])):(r(),u("div",Vt,[e("a",{class:"btn btn-success",onClick:a[0]||(a[0]=p=>o(s).getToken())},[c(_,{icon:"arrow-right-to-bracket"}),g(" Login")])]))])}}},Ft={__name:"HomeView",setup(t){return(s,n)=>(r(),L(Ht))}},zt={},Wt=t=>(W("data-v-6e27551f"),t=t(),J(),t),Jt={class:"pb-2 border-bottom"},Yt=Wt(()=>e("div",{class:"row p-4 pb-0 pt-lg-4 pb-lg-4 align-items-center rounded-3 border shadow-lg"},[e("div",{class:"col-lg-10 mx-auto"},[e("p",{class:"lead-custom text-center"}," Select a queue to join: ")])],-1));function Gt(t,s){const n=C("font-awesome-icon");return r(),u(x,null,[e("h2",Jt,[c(n,{icon:"chalkboard-teacher"}),g(" Office Hours Queue ")]),Yt],64)}const Xt=K(zt,[["render",Gt],["__scopeId","data-v-6e27551f"]]),P=V("queues",{state:()=>({queues:[],online:[],socket:void 0,connected:!1,error:!1}),getters:{getQueue:t=>s=>t.queues.find(n=>n.id==s),getOnline:t=>s=>t.online.find(n=>n.id==s)||{is_open:!1,helpers:0,requests:0},sortedQueues:t=>[...t.queues].sort((s,n)=>n.is_open-s.is_open)},actions:{async hydrate(){d.info("queues:hydrate"),await E.get("/api/v1/queues").then(t=>{this.queues=t.data})},async hydrateOnline(){d.info("queues:hydrateOnline"),this.socket&&(this.socket.disconnect(),this.online={});const t=R(),s="/status";this.socket=be(s,{auth:{token:t.token}}),this.socket.on("connect",()=>{d.info("socket:connect"),this.connected=!0,this.error=!1}),this.socket.on("connect_error",n=>{d.error("socket:connect_error - "+n),this.$reset,this.error=!0}),this.socket.on("disconnect",()=>{d.info("socket:disconnect"),this.connected=!1,this.error=!1}),this.socket.on("status:update",async n=>{d.info("status:update - "+n.id),d.debug("|- updated: "+n);var a=this.online.findIndex(i=>i.id===n.id);a<0?this.online.push(n):Object.assign(this.online[a],n)}),d.info("emit status:connect"),await this.socket.emit("status:connect",async(n,a)=>{n==200?(d.info("status:connect OK"),d.debug("|- online: "+a),this.online=a):d.error("status:connect error - "+n)})},async disconnectQueue(){this.socket&&(d.info("emit socket:disconnect"),this.socket.disconnect()),this.$reset()},async update(t){await E.post("/api/v1/queues/"+t.id,{queue:t}).then(async()=>{await this.hydrate()})},async deleteQueue(t){await E.delete("/api/v1/queues/"+t).then(async()=>{await this.hydrate()})},async addQueue(t){await E.put("/api/v1/queues/",{name:t}).then(async()=>{await this.hydrate()})}}}),Zt={class:"col"},es={class:"card-header"},ts={key:0,class:"float-end badge rounded-pill bg-success"},ss={key:1,class:"float-end badge rounded-pill bg-danger"},ns={class:"card-body"},os={class:"card-text"},as={__name:"QueueCard",props:{queue:{type:Object,default(){return{}}}},setup(t){const s=t,n=P(),{getOnline:a}=T(n),i=re();function _(p){i.push("/queues/"+p)}return(p,k)=>{const f=C("font-awesome-icon");return r(),u("div",Zt,[e("div",{class:"card w-100 hvr-grow",onClick:k[0]||(k[0]=m=>_(s.queue.id))},[e("h5",es,[g(v(s.queue.name)+" ",1),o(a)(s.queue.id).is_open===1?(r(),u("span",ts,[g("Open | "+v(o(a)(s.queue.id).helpers||0)+" ",1),c(f,{icon:"user-graduate"}),g(" | "+v(o(a)(s.queue.id).requests||0)+" ",1),c(f,{icon:"circle-question"})])):(r(),u("span",ss,"Closed"))]),e("div",ns,[e("p",os,v(s.queue.snippet),1)])])])}}},is=K(as,[["__scopeId","data-v-1d44794c"]]),rs={class:"row row-cols-1 row-cols-lg-3 g-4"},cs={__name:"QueueList",async setup(t){let s,n;const a=P();a.hydrate(),[s,n]=A(()=>a.hydrateOnline()),await s,n();const{sortedQueues:i}=T(a);return de(async()=>{await a.disconnectQueue()}),(_,p)=>(r(),u("div",rs,[(r(!0),u(x,null,D(o(i),(k,f)=>(r(),L(is,{key:k.id,queue:k,index:f},null,8,["queue","index"]))),128))]))}},ls=e("br",null,null,-1),ds={__name:"QueueListView",setup(t){return(s,n)=>(r(),u("main",null,[c(Xt),ls,c(cs)]))}},Z=V("requests",{state:()=>({requests:[],online:[],helpers:[],socket:void 0,connected:!1,error:!1}),getters:{getRequest:t=>s=>t.requests.find(n=>n.user_id===s),userOnline:t=>s=>t.online.find(n=>n==s)!==void 0,sortedRequests:t=>[...t.requests].sort(function(s,n){return s.status_id==n.status_id?s.id-n.id:n.status_id-s.status_id})},actions:{async connectQueue(t){this.socket&&this.socket.disconnect(),this.$reset();const s=R(),n="/";this.socket=be(n,{auth:{token:s.token,queue_id:t}}),this.socket.on("connect",()=>{d.info("socket:connect"),this.connected=!0,this.error=!1}),this.socket.on("connect_error",a=>{d.error("socket:connect_error - "+a),this.$reset,this.error=!0}),this.socket.on("disconnect",()=>{d.info("socket:disconnect"),this.connected=!1,this.error=!1}),this.socket.on("queue:update",async a=>{d.info("queue:update - "+a.id),d.debug("|- updated: "+a);var i=this.requests.findIndex(_=>_.id===a.id);i<0?(this.requests.push(a),s.sound&&new Audio("/ding-36029.mp3").play()):this.requests[i]=a}),this.socket.on("queue:remove",async a=>{d.info("queue.remove - "+a);var i=this.requests.findIndex(_=>_.id===a);i>=0&&this.requests.splice(i,1)}),this.socket.on("user:online",async a=>{d.info("user:online - "+a),this.online.push(String(a))}),this.socket.on("user:offline",async a=>{d.info("user:offline - "+a),this.online.splice(this.online.indexOf(String(a)),1)}),this.socket.on("helper:online",async a=>{d.info("helper:online - "+a.id),d.debug("|- helper: "+a),this.helpers.push(a)}),this.socket.on("helper:offline",async a=>{d.info("helper:offline - "+a),this.helpers.splice(this.helpers.findIndex(i=>i.id==a),1)}),this.socket.on("queue:opening",async()=>{d.info("queue:opening"),await P().hydrate()}),this.socket.on("connected",async(a,i)=>{d.info("socket:connected"),d.debug("|-online: "+a),d.debug("|-helpers: "+i),this.online=a,this.helpers=i}),this.socket.on("queue:closing",async()=>{d.info("queue:closing"),this.requests=[],await P().hydrate()}),d.info("emit queue:connect"),await this.socket.emit("queue:connect",async(a,i)=>{a==200?(d.info("queue:connect OK"),d.debug("|- requests: "+i),this.requests=i):d.error("queue:connect error - "+a)})},async disconnectQueue(){this.socket&&(d.info("emit socket:disconnect"),this.socket.disconnect()),this.$reset()},async joinQueue(){d.info("emit queue:join"),await this.socket.emit("queue:join",async t=>{t==200?d.info("queue:join OK"):d.error("queue:join error - "+t)})},async openQueue(){d.info("emit queue:open"),await this.socket.emit("queue:open",async t=>{t==200?(d.info("queue:open OK"),P().hydrate()):d.error("queue:open error - "+t)})},async closeQueue(){d.info("emit queue:close"),await this.socket.emit("queue:close",async t=>{t==200?(d.info("queue:close OK"),this.requests=[],P().hydrate()):d.error("queue:close error - "+t)})},async takeRequest(t){d.info("emit request:take - "+t),await this.socket.emit("request:take",t,async s=>{s==200?d.info("request:take OK"):d.error("request:take error - "+s)})},async deleteRequest(t){d.info("emit request:delete - "+t),await this.socket.emit("request:delete",t,async s=>{s==200?d.info("request:delete OK"):d.error("request:delete error - "+s)})},async finishRequest(t){d.info("emit request:finish - "+t),await this.socket.emit("request:finish",t,async s=>{s==200?d.info("request:finish OK"):d.error("request:finish error - "+s)})},async requeueRequest(t){d.info("emit request:requeue - "+t),await this.socket.emit("request:requeue",t,async s=>{s==200?d.info("request:requeue OK"):d.error("request:requeue error - "+s)})}}}),us=t=>(W("data-v-11287421"),t=t(),J(),t),_s={key:2,class:"badge bg-primary rounded-pill"},hs=us(()=>e("br",null,null,-1)),fs={id:"tooltip",class:"text-muted"},ms={__name:"RequestItem",props:{request:{type:Object,default(){return{}}},helper:{type:Boolean,default(){return!1}},userId:{type:Number,default(){return-1}}},setup(t){const s=t;var n=U({now:B.utc()});const a=Z(),i=async function(){await a.deleteRequest(s.request.id)},_=async function(){await a.takeRequest(s.request.id)},p=async function(){await a.finishRequest(s.request.id)},k=async function(){await a.requeueRequest(s.request.id)},f=G(()=>s.request.updated_at?n.now.to(s.request.updated_at):n.now.to(s.request.created_at));return(m,b)=>{const h=C("font-awesome-icon");return r(),u("li",{class:X(["list-group-item",[t.request.status_id==2?"list-group-item-primary":"",t.request.user_id==t.userId?"current-user":"",o(a).userOnline(t.request.user_id)?"":"list-group-item-light"]])},[o(a).userOnline(t.request.user_id)?(r(),L(h,{key:0,icon:"link"})):(r(),L(h,{key:1,icon:"link-slash"})),g(" "+v(t.request.user.name)+" ",1),t.helper?(r(),u(x,{key:2},[e("button",{class:"float-end btn btn-danger btn-sm mx-1",onClick:i},[c(h,{icon:"times",size:"xl"})]),e("button",{class:"float-end btn btn-secondary btn-sm mx-1",onClick:k},[c(h,{icon:"redo",size:"lg"})]),t.request.status_id==1?(r(),u("button",{key:0,class:"float-end btn btn-primary btn-sm mx-1",onClick:_}," Take ")):(r(),u("button",{key:1,class:"float-end btn btn-success btn-sm mx-1",onClick:p}," Done ")),t.request.status_id==2?(r(),u("span",_s,v(t.request.helper.name),1)):N("",!0),hs,e("small",fs,v(f.value),1)],64)):N("",!0)],2)}}},ps=K(ms,[["__scopeId","data-v-11287421"]]),bs=e("h3",{class:"text-center"},"Students Waiting",-1),ys=e("hr",null,null,-1),ks={class:"list-group list-group-numbered"},we={__name:"RequestList",props:{id:{type:Number,default:-1},helper:{type:Boolean,default(){return!1}}},setup(t){const s=t,n=R(),a=Z(),{sortedRequests:i}=T(a);return(_,p)=>(r(),u(x,null,[bs,ys,e("ul",ks,[(r(!0),u(x,null,D(o(i),(k,f)=>(r(),L(ps,Qe({key:k.id,request:k,index:f},_.$attrs,{"user-id":o(n).id,helper:s.helper}),null,16,["request","index","user-id","helper"]))),128))])],64))}},vs=e("h3",{class:"text-center"},"Helpers Online",-1),gs=e("hr",null,null,-1),ws={class:"list-group list-group-flush"},$e={__name:"HelperList",setup(t){const s=Z(),{helpers:n}=T(s);return(a,i)=>{const _=C("font-awesome-icon");return r(),u(x,null,[vs,gs,e("ul",ws,[(r(!0),u(x,null,D(o(n),(p,k)=>(r(),u("li",{key:k,class:"list-group-item"},[c(_,{icon:"link"}),g(" "+v(p.name),1)]))),128))])],64)}}},Y=t=>(W("data-v-0509c2d5"),t=t(),J(),t),$s={class:"queue-header mx-auto"},qs={key:0,class:"btn btn-outline-success float-end disabled"},xs=Y(()=>e("span",{class:"visually-hidden"},"Connected!",-1)),Ss=Y(()=>e("span",{class:"visually-hidden"},"Disconnected!",-1)),Cs=Y(()=>e("span",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},null,-1)),Qs=Y(()=>e("span",{class:"visually-hidden"},"Connecting...",-1)),Es=[Cs,Qs],Ls=Y(()=>e("h2",{class:"text-center"},"Moderate Queue",-1)),Os=Y(()=>e("hr",null,null,-1)),Is={class:"row"},Ts={class:"col-12 col-md-4 mb-4"},Rs={class:"col-12 col-md-8 mb-4"},As={__name:"HelperPane",props:{id:{type:Number,default:-1}},async setup(t){let s,n;const a=t,i=P();[s,n]=A(()=>i.hydrate()),await s,n();const _=i.getQueue,p=Z(),{connected:k,error:f}=T(p);[s,n]=A(()=>p.connectQueue(a.id)),await s,n();const m=async function(){confirm("Are you sure? All pending requests will be lost!")&&await p.closeQueue()},b=async function(){await p.openQueue()},h=async function(){await p.connectQueue(a.id)};return de(async()=>{await p.disconnectQueue()}),(l,y)=>{const q=C("font-awesome-icon");return r(),u(x,null,[e("div",$s,[o(k)?(r(),u("button",qs,[c(q,{icon:"link"}),xs])):(r(),u(x,{key:1},[o(f)?(r(),u("button",{key:0,class:"btn btn-outline-danger float-end",onClick:h},[c(q,{icon:"link-slash"}),Ss])):(r(),u("button",{key:1,class:"btn btn-outline-warning float-end",onClick:h},Es))],64)),Ls,o(_)(t.id).is_open==1?(r(),u("a",{key:2,class:"w-100 btn btn-success",onClick:m},"Queue is Open - Click to Close")):(r(),u("a",{key:3,class:"w-100 btn btn-danger",onClick:b},"Queue is Closed - Click to Open"))]),Os,e("div",Is,[e("div",Ts,[c($e)]),e("div",Rs,[c(we,{id:t.id,helper:""},null,8,["id"])])])],64)}}},Ps=K(As,[["__scopeId","data-v-0509c2d5"]]),M=t=>(W("data-v-fb79369c"),t=t(),J(),t),Ds={id:"studentModal",class:"modal fade",tabindex:"-1","aria-labelledby":"studentModalLabel","aria-hidden":"true"},js={class:"modal-dialog"},Ms={class:"modal-content"},Ns=M(()=>e("div",{class:"modal-header"},[e("h5",{id:"studentModalLabel",class:"modal-title"}," Your Turn! "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),Ks={class:"modal-body"},Bs=M(()=>e("hr",null,null,-1)),Us=["innerHTML"],Vs=M(()=>e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," OK ")],-1)),Hs={class:"queue-header mx-auto"},Fs={key:0,class:"btn btn-outline-success float-end disabled"},zs=M(()=>e("span",{class:"visually-hidden"},"Connected!",-1)),Ws=M(()=>e("span",{class:"visually-hidden"},"Disconnected!",-1)),Js=M(()=>e("span",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},null,-1)),Ys=M(()=>e("span",{class:"visually-hidden"},"Connecting...",-1)),Gs=[Js,Ys],Xs=M(()=>e("h2",{class:"text-center"},"Waiting Queue",-1)),Zs={key:0,class:"w-100 btn btn-success disabled",disabled:""},en={key:3,class:"w-100 btn btn-danger disabled",disabled:""},tn=M(()=>e("hr",null,null,-1)),sn={key:0,class:"row"},nn={class:"col-12 col-md-4 mb-4"},on={class:"col-12 col-md-8 mb-4"},an={__name:"StudentPane",props:{id:{type:Number,default:-1}},async setup(t){let s,n;const a=t,i=R(),_=P();[s,n]=A(()=>_.hydrate()),await s,n();const p=_.getQueue,k=Z(),f=k.getRequest,{connected:m,error:b}=T(k);[s,n]=A(()=>k.connectQueue(a.id)),await s,n();var h,l=!1;k.$subscribe(()=>{const w=f(i.id);w&&w.status_id==2&&!l&&(l=!0,h=new ue("#studentModal",{}),h.show(),i.sound&&new Audio("/ding-36029.mp3").play()),w||(l=!1)});const y=async function(){l=!1,await k.joinQueue()},q=async function(){await k.connectQueue(a.id)};return de(async()=>{await k.disconnectQueue()}),(w,Q)=>{const I=C("font-awesome-icon");return r(),u(x,null,[e("div",Ds,[e("div",js,[e("div",Ms,[Ns,e("div",Ks,[o(f)(o(i).id)&&o(f)(o(i).id).helper?(r(),u(x,{key:0},[e("p",null,[g(" You will be helped by "),e("strong",null,v(o(f)(o(i).id).helper.name),1),g(". Their contact info is below: ")]),Bs,e("div",{innerHTML:o(ye).sanitize(o(ke).parse(o(f)(o(i).id).helper.contact_info||""))},null,8,Us)],64)):N("",!0)]),Vs])])]),e("div",Hs,[o(m)?(r(),u("button",Fs,[c(I,{icon:"link"}),zs])):(r(),u(x,{key:1},[o(b)?(r(),u("button",{key:0,class:"btn btn-outline-danger float-end",onClick:q},[c(I,{icon:"link-slash"}),Ws])):(r(),u("button",{key:1,class:"btn btn-outline-warning float-end",onClick:q},Gs))],64)),Xs,o(p)(t.id).is_open==1?(r(),u(x,{key:2},[o(f)(o(i).id)!=null?(r(),u("a",Zs,"Queue Joined")):(r(),u("a",{key:1,class:"w-100 btn btn-success",onClick:Q[0]||(Q[0]=O=>y())},"Join Queue"))],64)):(r(),u("a",en,"Queue is Closed"))]),tn,o(p)(t.id).is_open==1?(r(),u("div",sn,[e("div",nn,[c($e)]),e("div",on,[c(we,{id:t.id},null,8,["id"])])])):N("",!0)],64)}}},rn=K(an,[["__scopeId","data-v-fb79369c"]]),cn={class:"display-5 text-center"},ln=e("hr",null,null,-1),dn=["innerHTML"],un=e("hr",null,null,-1),_n={__name:"QueueSingle",props:{id:{type:Number,default:-1}},async setup(t){let s,n;const a=R(),i=P();[s,n]=A(()=>i.hydrate()),await s,n();const _=i.getQueue;return(p,k)=>{const f=C("font-awesome-icon");return r(),u("main",null,[c(o(j),{to:{name:"queues"},class:"btn btn-secondary float-start"},{default:$(()=>[c(f,{icon:"arrow-left"}),g(" Back")]),_:1}),o(a).is_admin?(r(),L(o(j),{key:0,to:{name:"queue_edit",params:{id:t.id}},class:"btn btn-secondary float-end"},{default:$(()=>[c(f,{icon:"pen-to-square"}),g(" Edit")]),_:1},8,["to"])):N("",!0),e("h1",cn,v(o(_)(t.id).name),1),ln,e("div",{innerHTML:o(ye).sanitize(o(ke).parse(o(_)(t.id).description||""))},null,8,dn),un,o(_)(t.id).helper==1?(r(),L(Ps,{key:1,id:t.id},null,8,["id"])):(r(),L(rn,{key:2,id:t.id},null,8,["id"]))])}}},hn={__name:"QueueSingleView",setup(t){return(s,n)=>(r(),L(_n))}},fe=V("users",{state:()=>({users:[]}),getters:{getUser:t=>s=>t.users.find(n=>n.id===s)},actions:{async hydrate(){d.info("users:hydrate"),await E.get("/api/v1/users").then(t=>{this.users=t.data})},async update(t){await E.post("/api/v1/users/"+t.id,{user:t}).then(async()=>{await this.hydrate()})},async deleteUser(t){await E.delete("/api/v1/users/"+t).then(async()=>{await this.hydrate()})},async addUser(t){await E.put("/api/v1/users/",{eid:t}).then(async()=>{await this.hydrate()})}}}),fn=e("h1",{class:"display-5 text-center"},"Edit Queue",-1),mn=e("hr",null,null,-1),pn={class:"mb-3"},bn=e("label",{for:"multiselect-users",class:"form-label"},"Helpers",-1),yn=e("div",{class:"form-text"}," Helpers who can manage the queue (usually TAs) - admins already have access ",-1),kn={class:"row row-cols-1 row-cols-md-2"},vn=e("div",{class:"col d-grid mb-2"},[e("button",{class:"btn btn-success"},"Save")],-1),gn={class:"col d-grid mb-2"},wn={__name:"EditQueue",props:{id:{type:Number,default:-1},admin:{type:Boolean,default:!1}},async setup(t){let s,n;const a=re(),i=t,_=P();[s,n]=A(()=>_.hydrate()),await s,n();const p=_.getQueue(i.id),k=fe();k.hydrate();const{users:f}=T(k);var m;_e(()=>{m=new he({autoDownloadFontAwesome:!1,blockStyles:{italic:"_"},status:!1,spellChecker:!1})});const b=async h=>{h=(({id:l,name:y,snippet:q})=>({id:l,name:y,snippet:q}))(h),h.description=m.value(),h.users=[];for(const l of p.users)h.users.push({id:l.id});try{await _.update(h),i.admin?a.push("/admin"):a.push("/queues/"+p.id)}catch(l){if(l.response&&l.response.status===422){let y={};if(l.response.data.data){for(const q in l.response.data.data){y[q]="";for(const w of l.response.data.data[q])y[q]=y[q]+w.message+" "}z("queueform",["The server rejected this submission. Please correct errors listed above"],y)}else z("queueform",["The server rejected this submission due to an SQL Error. Refresh and try again"])}else console.error(l)}};return(h,l)=>{const y=C("FormKit"),q=C("router-link");return r(),u("main",null,[fn,mn,c(y,{id:"queueform",type:"form",value:o(p),actions:!1,onSubmit:b},{default:$(()=>[c(y,{type:"text",name:"name",label:"Queue Name",help:"Name of the queue (usually the course)",validation:"required"}),c(y,{type:"text",name:"snippet",label:"Short Description",help:"Short description shown on the initial card"}),c(y,{type:"textarea",name:"description",label:"Long Description",help:"Long description shown on the queue page",rows:"10"}),e("div",pn,[bn,c(o(ve),{id:"multiselect-users",modelValue:o(p).users,"onUpdate:modelValue":l[0]||(l[0]=w=>o(p).users=w),class:"form-control",options:o(f),multiple:!0,"tag-placeholder":"Add this as new user",placeholder:"Type to search or add user",label:"eid","track-by":"id"},null,8,["modelValue","options"]),yn]),e("div",kn,[vn,e("div",gn,[t.admin?(r(),L(q,{key:0,to:{name:"admin"},class:"btn btn-secondary"},{default:$(()=>[g(" Cancel")]),_:1})):(r(),L(q,{key:1,to:{name:"queue_single",params:{id:o(p).id}},class:"btn btn-secondary"},{default:$(()=>[g(" Cancel")]),_:1},8,["to"]))])])]),_:1},8,["value"])])}}},$n={__name:"QueueEditView",setup(t){return(s,n)=>(r(),L(wn))}},qn=V("profile",{state:()=>({user:{}}),actions:{async hydrate(){d.info("profile:hydrate"),await E.get("/api/v1/profile").then(t=>{this.user=t.data})},async update(t){await E.post("/api/v1/profile/",{user:t}).then(async()=>{await this.hydrate()})}}}),xn=e("h1",{class:"display-5 text-center"},"Edit User",-1),Sn=e("hr",null,null,-1),Cn={class:"row row-cols-1 row-cols-md-2"},Qn=e("div",{class:"col d-grid mb-2"},[e("button",{class:"btn btn-success"},"Save")],-1),En={class:"col d-grid mb-2"},Ln={__name:"EditProfile",async setup(t){let s,n;const a=re(),i=qn();[s,n]=A(()=>i.hydrate()),await s,n();const{user:_}=T(i);var p;_e(()=>{p=new he({autoDownloadFontAwesome:!1,blockStyles:{italic:"_"},status:!1,spellChecker:!1})});const k=async f=>{const m={name:f.name,contact_info:p.value()};try{await i.update(m),a.push("/queues/")}catch(b){if(b.response&&b.response.status===422){let h={};if(b.response.data.data){for(const l in b.response.data.data){h[l]="";for(const y of b.response.data.data[l])h[l]=h[l]+y.message+" "}z("userform",["The server rejected this submission. Please correct errors listed above"],h)}else z("userform",["The server rejected this submission due to an SQL Error. Refresh and try again"])}else console.error(b)}};return(f,m)=>{const b=C("FormKit"),h=C("router-link");return r(),u("main",null,[xn,Sn,c(b,{id:"userform",type:"form",value:o(_),actions:!1,onSubmit:k},{default:$(()=>[c(b,{type:"text",name:"eid",label:"eID",disabled:!0,help:"Your K-State eID (cannot be changed)",validation:"required"}),c(b,{type:"text",name:"name",label:"Name",help:"Your full name as you'd like it displayed on the site",validation:"required"}),c(b,{type:"textarea",name:"contact_info",label:"Contact Information",help:"Any information we should know about how to contact you",rows:"10"}),e("div",Cn,[Qn,e("div",En,[c(h,{to:{name:"queues"},class:"btn btn-secondary"},{default:$(()=>[g(" Cancel")]),_:1})])])]),_:1},8,["value"])])}}},On={__name:"ProfileView",setup(t){return(s,n)=>(r(),L(Ln))}},In={id:"userModal",class:"modal fade",tabindex:"-1","aria-labelledby":"userModalLabel","aria-hidden":"true"},Tn={class:"modal-dialog"},Rn={class:"modal-content"},An=e("div",{class:"modal-header"},[e("h5",{id:"userModalLabel",class:"modal-title"}," Delete User "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Pn={class:"modal-body"},Dn=e("h5",null,"Are you sure you want to delete this user?",-1),jn=e("strong",null,"eID: ",-1),Mn=e("br",null,null,-1),Nn=e("strong",null,"Name: ",-1),Kn={class:"modal-footer"},Bn=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1),Un=e("h1",{class:"text-center"},"Users",-1),Vn={class:"table table-striped table-hover"},Hn=e("thead",null,[e("tr",null,[e("th",null,"eID"),e("th",null,"Name"),e("th",null,"Roles"),e("th",null,"Actions")])],-1),Fn=["onClick"],zn={__name:"UserAdmin",setup(t){const s=fe();s.hydrate();const{users:n}=T(s),a=R();var i=U({}),_;const p=function(m){i.id=m.id,i.eid=m.eid,i.name=m.name,_=new ue("#userModal",{}),_.show()},k=async function(m){await s.deleteUser(m),_.hide()},f=async function(){var m=prompt("Enter an eID to create a user");if(m)try{await s.addUser(m)}catch(b){b.response&&b.response.status===422?alert(JSON.stringify(b.response.data)):alert(b)}};return(m,b)=>{const h=C("font-awesome-icon");return r(),u(x,null,[e("div",In,[e("div",Tn,[e("div",Rn,[An,e("div",Pn,[Dn,e("p",null,[jn,g(v(o(i).eid)+" ",1),Mn,Nn,g(v(o(i).name),1)])]),e("div",Kn,[Bn,e("button",{type:"button",class:"btn btn-danger",onClick:b[0]||(b[0]=l=>k(o(i).id))},[c(h,{icon:"trash"}),g(" Delete User ")])])])])]),e("button",{type:"button",class:"btn btn-success float-end",onClick:f},[c(h,{icon:"plus"}),g(" User ")]),Un,e("table",Vn,[Hn,e("tbody",null,[(r(!0),u(x,null,D(o(n),l=>(r(),u("tr",{key:l.id},[e("td",null,v(l.eid),1),e("td",null,v(l.name),1),e("td",null,[(r(!0),u(x,null,D(l.roles,y=>(r(),u("span",{key:y.id,class:"badge rounded-pill bg-success"},v(y.name),1))),128))]),e("td",null,[c(o(j),{to:{name:"admin_useredit",params:{id:l.id}},class:"btn btn-secondary btn-sm mx-1"},{default:$(()=>[c(h,{icon:"pen-to-square"})]),_:2},1032,["to"]),l.id!=o(a).id?(r(),u("button",{key:0,type:"button",class:"btn btn-danger btn-sm mx-1",onClick:ge(y=>p(l),["prevent"])},[c(h,{icon:"trash"})],8,Fn)):N("",!0)])]))),128))])])],64)}}},Wn={id:"queueModal",class:"modal fade",tabindex:"-1","aria-labelledby":"queueModalLabel","aria-hidden":"true"},Jn={class:"modal-dialog"},Yn={class:"modal-content"},Gn=e("div",{class:"modal-header"},[e("h5",{id:"queueModalLabel",class:"modal-title"}," Delete Queue "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Xn={class:"modal-body"},Zn=e("h5",null,"Are you sure you want to delete this queue?",-1),eo=e("strong",null,"Name: ",-1),to={class:"modal-footer"},so=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1),no=e("h1",{class:"text-center"},"Queues",-1),oo={class:"table table-striped table-hover"},ao=e("thead",null,[e("tr",null,[e("th",null,"Name"),e("th",null,"Actions")])],-1),io=["onClick"],ro={__name:"QueueAdmin",setup(t){const s=P();s.hydrate();const{queues:n}=T(s);var a=U({}),i;const _=function(f){a.id=f.id,a.name=f.name,i=new ue("#queueModal",{}),i.show()},p=async function(f){await s.deleteQueue(f),i.hide()},k=async function(){var f=prompt("Enter a name for the new queue");if(f)try{await s.addQueue(f)}catch(m){m.response&&m.response.status===422?alert(JSON.stringify(m.response.data)):alert(m)}};return(f,m)=>{const b=C("font-awesome-icon"),h=C("router-link");return r(),u(x,null,[e("div",Wn,[e("div",Jn,[e("div",Yn,[Gn,e("div",Xn,[Zn,e("p",null,[eo,g(v(o(a).name),1)])]),e("div",to,[so,e("button",{type:"button",class:"btn btn-danger",onClick:m[0]||(m[0]=l=>p(o(a).id))},[c(b,{icon:"trash"}),g(" Delete Queue ")])])])])]),e("button",{type:"button",class:"btn btn-success float-end",onClick:k},[c(b,{icon:"plus"}),g(" Queue ")]),no,e("table",oo,[ao,e("tbody",null,[(r(!0),u(x,null,D(o(n),l=>(r(),u("tr",{key:l.id},[e("td",null,v(l.name),1),e("td",null,[c(h,{to:{name:"queue_edit",params:{id:l.id,admin:!0}},class:"btn btn-secondary btn-sm mx-1"},{default:$(()=>[c(b,{icon:"pen-to-square"})]),_:2},1032,["to"]),e("button",{type:"button",class:"btn btn-danger btn-sm mx-1",onClick:ge(y=>_(l),["prevent"])},[c(b,{icon:"trash"})],8,io)])]))),128))])])],64)}}},co={__name:"AdminView",setup(t){return(s,n)=>(r(),u(x,null,[c(ro),c(zn)],64))}},lo=V("roles",{state:()=>({roles:[]}),actions:{async hydrate(){d.info("roles:hydrate"),await E.get("/api/v1/roles").then(t=>{this.roles=t.data})}}}),uo=e("h1",{class:"display-5 text-center"},"Edit User",-1),_o=e("hr",null,null,-1),ho={class:"mb-3"},fo=e("label",{for:"multiselect-roles",class:"form-label"},"Roles",-1),mo=e("div",{class:"form-text"},"Roles assigned to this user",-1),po={class:"row row-cols-1 row-cols-md-2"},bo=e("div",{class:"col d-grid mb-2"},[e("button",{class:"btn btn-success"},"Save")],-1),yo={class:"col d-grid mb-2"},ko={__name:"UserEdit",props:{id:{type:Number,default:-1}},async setup(t){let s,n;const a=re(),i=t,_=fe();[s,n]=A(()=>_.hydrate()),await s,n();const p=_.users.find(h=>h.id===parseInt(i.id)),k=lo();k.hydrate();const{roles:f}=T(k);var m;_e(()=>{m=new he({autoDownloadFontAwesome:!1,blockStyles:{italic:"_"},status:!1,spellChecker:!1})});const b=async h=>{h=(({id:l,name:y})=>({id:l,name:y}))(h),h.contact_info=m.value(),h.roles=[];for(const l of p.roles)h.roles.push({id:l.id});try{await _.update(h),a.push("/admin/")}catch(l){if(l.response&&l.response.status===422){let y={};if(l.response.data.data){for(const q in l.response.data.data){y[q]="";for(const w of l.response.data.data[q])y[q]=y[q]+w.message+" "}z("usersForm",["The server rejected this submission. Please correct errors listed above"],y)}else z("usersForm",["The server rejected this submission due to an SQL Error. Refresh and try again"])}else console.error(l)}};return(h,l)=>{const y=C("FormKit"),q=C("router-link");return r(),u("main",null,[uo,_o,c(y,{id:"userform",type:"form",value:o(p),actions:!1,onSubmit:b},{default:$(()=>[c(y,{type:"text",name:"eid",label:"eID",disabled:!0,help:"The user's K-State eID (cannot be changed)",validation:"required"}),c(y,{type:"text",name:"name",label:"Name",help:"The user's full name as you'd like it displayed on the site",validation:"required"}),c(y,{type:"textarea",name:"contact_info",label:"Contact Information",help:"Any information we should know about how to contact the user",rows:"10"}),e("div",ho,[fo,c(o(ve),{id:"multiselect-roles",modelValue:o(p).roles,"onUpdate:modelValue":l[0]||(l[0]=w=>o(p).roles=w),class:"form-control",options:o(f),multiple:!0,"tag-placeholder":"Add this as new role",placeholder:"Type to search or add role",label:"name","track-by":"id"},null,8,["modelValue","options"]),mo]),e("div",po,[bo,e("div",yo,[c(q,{to:{name:"admin"},class:"btn btn-secondary"},{default:$(()=>[g(" Cancel")]),_:1})])])]),_:1},8,["value"])])}}},vo={__name:"UserEditView",setup(t){return(s,n)=>(r(),L(ko))}},me=V("periods",{state:()=>({queues:[],periods:[],events:[],presences:[]}),getters:{getPeriod:t=>s=>t.periods.find(n=>n.id==s),getEventsTimline:t=>{var s=[{name:"Queued",data:[]},{name:"Taken",data:[]}];for(var n of t.events)n.status=="Queued"?s[0].data.push({x:n.eid,y:[B(n.created_at).valueOf(),n.updated_at===null?B().valueOf():B(n.updated_at).valueOf()]}):n.status=="Taken"&&s[1].data.push({x:n.eid,y:[B(n.created_at).valueOf(),n.updated_at===null?B().valueOf():B(n.updated_at).valueOf()],z:n.presence?n.presence.eid:""});return s}},actions:{async hydrate(){d.info("periods:hydrate"),await E.get("/api/v1/periods").then(t=>{this.queues=t.data})},async loadPeriods(t){d.info("periods:hydrate - "+t),await E.get("/api/v1/periods?name="+t).then(s=>{this.periods=s.data})},async loadEvents(t){d.info("periods:hydrate - "+t),await E.get("/api/v1/periods/"+t).then(s=>{this.events=s.data.events,this.presences=s.data.presences})}}}),go=e("h1",{class:"display-5 text-center"},"Event Log: Queues",-1),wo=["data-page-count"],$o={class:"col-md-6 mb-2 mb-md-0"},qo={class:"col-md-6"},xo={class:"row"},So={class:"col-md-12"},Co={class:"table-responsive"},Qo={class:"table table-striped d-md-table"},Eo=["onClick"],Lo=e("i",{class:"gg-select float-right"},null,-1),Oo=e("th",null,"Actions",-1),Io={class:"d-flex flex-md-row flex-column justify-content-between align-items-center"},To={__name:"QueueList",async setup(t){let s,n;const a=me();[s,n]=A(()=>a.hydrate()),await s,n();const{queues:i}=T(a),_=U([{name:"Queue",field:"queue_name",sort:""},{name:"Periods",field:"periods",sort:""},{name:"Recent",field:"recent",sort:""}]),p=function(f,m){let b;const h=_[m];f.shiftKey||this.cols.forEach(l=>{l.field!==h.field&&(l.sort="")}),h.sort||(b="asc"),h.sort==="desc"&&(b=f.shiftKey?"":"asc"),h.sort==="asc"&&(b="desc"),h.sort=b},k=G(()=>_.reduce((f,m)=>(m.sort&&(m.sort==="asc"?f.push(m.field):f.push("-"+m.field)),f),[]));return(f,m)=>{const b=C("router-link");return r(),u(x,null,[go,c(o(ie),{"ds-data":o(i),"ds-sortby":k.value},{default:$(({ds:h})=>[e("div",{class:"row","data-page-count":h.dsPagecount},[e("div",$o,[c(o(te),{"ds-show-entries":"25"})]),e("div",qo,[c(o(se),{"ds-search-placeholder":"Search..."})])],8,wo),e("div",xo,[e("div",So,[e("div",Co,[e("table",Qo,[e("thead",null,[e("tr",null,[(r(!0),u(x,null,D(_,(l,y)=>(r(),u("th",{key:l.field,class:X(["sort",l.sort]),onClick:q=>p(q,y)},[g(v(l.name)+" ",1),Lo],10,Eo))),128)),Oo])]),c(o(ne),{tag:"tbody"},{default:$(({row:l})=>[e("tr",null,[e("td",null,v(l.queue_name),1),e("td",null,v(l.periods),1),e("td",null,v(l.recent),1),e("td",null,[c(b,{to:{name:"data_periods",params:{name:l.queue_name}},class:"btn btn-secondary btn-sm mx-1"},{default:$(()=>[g("View")]),_:2},1032,["to"])])])]),_:1})])])])]),e("div",Io,[c(o(oe),{class:"mb-2 mb-md-0"}),c(o(ae))])]),_:1},8,["ds-data","ds-sortby"])],64)}}},Ro={__name:"DashboardView",setup(t){return(s,n)=>(r(),L(To))}},Ao={class:"display-5 text-center"},Po=["data-page-count"],Do={class:"col-md-6 mb-2 mb-md-0"},jo={class:"col-md-6"},Mo={class:"row"},No={class:"col-md-12"},Ko={class:"table-responsive"},Bo={class:"table table-striped d-md-table"},Uo=["onClick"],Vo=e("i",{class:"gg-select float-right"},null,-1),Ho=e("th",null,"Actions",-1),Fo={class:"d-flex flex-md-row flex-column justify-content-between align-items-center"},zo={__name:"PeriodList",props:{name:{type:String,default:""}},async setup(t){let s,n;const a=t,i=me();[s,n]=A(()=>i.loadPeriods(a.name)),await s,n();const{periods:_}=T(i),p=U([{name:"ID",field:"id",sort:""},{name:"Opened",field:"created_at",sort:""},{name:"Closed",field:"updated_at",sort:""},{name:"Events",field:"events",sort:""}]),k=function(m,b){let h;const l=p[b];m.shiftKey||this.cols.forEach(y=>{y.field!==l.field&&(y.sort="")}),l.sort||(h="asc"),l.sort==="desc"&&(h=m.shiftKey?"":"asc"),l.sort==="asc"&&(h="desc"),l.sort=h},f=G(()=>p.reduce((m,b)=>(b.sort&&(b.sort==="asc"?m.push(b.field):m.push("-"+b.field)),m),[]));return(m,b)=>{const h=C("router-link");return r(),u(x,null,[e("h1",Ao,"Event Log: "+v(t.name),1),c(o(ie),{"ds-data":o(_),"ds-sortby":f.value},{default:$(({ds:l})=>[e("div",{class:"row","data-page-count":l.dsPagecount},[e("div",Do,[c(o(te),{"ds-show-entries":"25"})]),e("div",jo,[c(o(se),{"ds-search-placeholder":"Search..."})])],8,Po),e("div",Mo,[e("div",No,[e("div",Ko,[e("table",Bo,[e("thead",null,[e("tr",null,[(r(!0),u(x,null,D(p,(y,q)=>(r(),u("th",{key:y.field,class:X(["sort",y.sort]),onClick:w=>k(w,q)},[g(v(y.name)+" ",1),Vo],10,Uo))),128)),Ho])]),c(o(ne),{tag:"tbody"},{default:$(({row:y})=>[e("tr",null,[e("td",null,v(y.id),1),e("td",null,v(y.created_at),1),e("td",null,v(y.updated_at),1),e("td",null,v(y.events),1),e("td",null,[c(h,{to:{name:"period",params:{id:y.id}},class:"btn btn-secondary btn-sm mx-1"},{default:$(()=>[g("View")]),_:2},1032,["to"])])])]),_:1})])])])]),e("div",Fo,[c(o(oe),{class:"mb-2 mb-md-0"}),c(o(ae))])]),_:1},8,["ds-data","ds-sortby"])],64)}}},Wo={__name:"PeriodView",setup(t){return(s,n)=>(r(),L(zo))}},Jo={class:"display-5 text-center"},Yo=e("h2",{class:"text-center"},"Events",-1),Go=["data-page-count"],Xo={class:"col-md-6 mb-2 mb-md-0"},Zo={class:"col-md-6"},ea={class:"row"},ta={class:"col-md-12"},sa={class:"table-responsive"},na={class:"table table-striped d-md-table"},oa=["onClick"],aa=e("i",{class:"gg-select float-right"},null,-1),ia={class:"d-flex flex-md-row flex-column justify-content-between align-items-center"},ra=e("h2",{class:"text-center"},"Presences",-1),ca=["data-page-count"],la={class:"col-md-6 mb-2 mb-md-0"},da={class:"col-md-6"},ua={class:"row"},_a={class:"col-md-12"},ha={class:"table-responsive"},fa={class:"table table-striped d-md-table"},ma=["onClick"],pa=e("i",{class:"gg-select float-right"},null,-1),ba={class:"d-flex flex-md-row flex-column justify-content-between align-items-center"},ya={__name:"EventList",props:{id:{type:Number,default:-1}},async setup(t){let s,n;const a=t,i=me();[s,n]=A(()=>i.loadEvents(a.id)),await s,n();const{events:_,presences:p,getEventsTimline:k}=T(i),f=U([{name:"ID",field:"id",sort:""},{name:"eID",field:"eid",sort:""},{name:"Status",field:"status",sort:""},{name:"Start",field:"created_at",sort:""},{name:"End",field:"updated_at",sort:""},{name:"Helper",field:"presence.eid",sort:""}]),m=U([{name:"ID",field:"id",sort:""},{name:"eID",field:"eid",sort:""},{name:"Start",field:"created_at",sort:""},{name:"End",field:"updated_at",sort:""}]),b=function(w,Q){let I;const O=f[Q];w.shiftKey||this.eventCols.forEach(S=>{S.field!==O.field&&(S.sort="")}),O.sort||(I="asc"),O.sort==="desc"&&(I=w.shiftKey?"":"asc"),O.sort==="asc"&&(I="desc"),O.sort=I},h=function(w,Q){let I;const O=m[Q];w.shiftKey||this.presenceCols.forEach(S=>{S.field!==O.field&&(S.sort="")}),O.sort||(I="asc"),O.sort==="desc"&&(I=w.shiftKey?"":"asc"),O.sort==="asc"&&(I="desc"),O.sort=I},l=G(()=>f.reduce((w,Q)=>(Q.sort&&(Q.sort==="asc"?w.push(Q.field):w.push("-"+Q.field)),w),[])),y=G(()=>m.reduce((w,Q)=>(Q.sort&&(Q.sort==="asc"?w.push(Q.field):w.push("-"+Q.field)),w),[])),q={chart:{type:"rangeBar"},plotOptions:{bar:{horizontal:!0,barHeight:"50%",rangeBarGroupRows:!0}},xaxis:{type:"datetime",labels:{datetimeUTC:!1}},dataLabels:{enabled:!0,formatter:function(w,Q){return Q.w.config.series[Q.seriesIndex].data[Q.dataPointIndex].z}}};return(w,Q)=>{const I=C("apexchart");return r(),u(x,null,[e("h1",Jo,"Event Log: Period "+v(t.id),1),Yo,e("div",null,[c(I,{type:"rangeBar",options:q,series:o(k)},null,8,["series"])]),c(o(ie),{"ds-data":o(_),"ds-sortby":l.value},{default:$(({ds:O})=>[e("div",{class:"row","data-page-count":O.dsPagecount},[e("div",Xo,[c(o(te),{"ds-show-entries":"25"})]),e("div",Zo,[c(o(se),{"ds-search-placeholder":"Search..."})])],8,Go),e("div",ea,[e("div",ta,[e("div",sa,[e("table",na,[e("thead",null,[e("tr",null,[(r(!0),u(x,null,D(f,(S,ce)=>(r(),u("th",{key:S.field,class:X(["sort",S.sort]),onClick:le=>b(le,ce)},[g(v(S.name)+" ",1),aa],10,oa))),128))])]),c(o(ne),{tag:"tbody"},{default:$(({row:S})=>[e("tr",null,[e("td",null,v(S.id),1),e("td",null,v(S.eid),1),e("td",null,v(S.status),1),e("td",null,v(S.created_at),1),e("td",null,v(S.updated_at),1),e("td",null,v(S.presence?S.presence.eid:""),1)])]),_:1})])])])]),e("div",ia,[c(o(oe),{class:"mb-2 mb-md-0"}),c(o(ae))])]),_:1},8,["ds-data","ds-sortby"]),ra,c(o(ie),{"ds-data":o(p),"ds-sortby":y.value},{default:$(({ds:O})=>[e("div",{class:"row","data-page-count":O.dsPagecount},[e("div",la,[c(o(te),{"ds-show-entries":"25"})]),e("div",da,[c(o(se),{"ds-search-placeholder":"Search..."})])],8,ca),e("div",ua,[e("div",_a,[e("div",ha,[e("table",fa,[e("thead",null,[e("tr",null,[(r(!0),u(x,null,D(m,(S,ce)=>(r(),u("th",{key:S.field,class:X(["sort",S.sort]),onClick:le=>h(le,ce)},[g(v(S.name)+" ",1),pa],10,ma))),128))])]),c(o(ne),{tag:"tbody"},{default:$(({row:S})=>[e("tr",null,[e("td",null,v(S.id),1),e("td",null,v(S.eid),1),e("td",null,v(S.created_at),1),e("td",null,v(S.updated_at),1)])]),_:1})])])])]),e("div",ba,[c(o(oe),{class:"mb-2 mb-md-0"}),c(o(ae))])]),_:1},8,["ds-data","ds-sortby"])],64)}}},ka={__name:"EventView",setup(t){return(s,n)=>(r(),L(ya))}},F=()=>R().is_admin,qe=Ee({history:Le("/"),routes:[{path:"/",name:"home",component:Ft},{path:"/about",name:"about",component:()=>Oe(()=>import("./AboutView-BIVARLVw.js"),__vite__mapDeps([0,1]))},{path:"/queues",name:"queues",component:ds},{path:"/queues/:id",name:"queue_single",component:hn,props:t=>({id:Number(t.params.id)})},{path:"/queues/:id/edit",name:"queue_edit",component:$n,props:!0,beforeEnter:F},{path:"/profile",name:"profile",component:On},{path:"/admin",name:"admin",component:co,beforeEnter:F},{path:"/admin/user/:id/edit",name:"admin_useredit",component:vo,props:!0,beforeEnter:F},{path:"/data",name:"data",component:Ro,beforeEnter:F},{path:"/data/:name",name:"data_periods",component:Wo,beforeEnter:F,props:t=>({name:t.params.name})},{path:"/period/:id",name:"period",component:ka,beforeEnter:F,props:t=>({id:t.params.id})}]});qe.beforeEach(async function(t){if(t.name!=="home"&&t.name!=="about"){const s=R();if(s.token||await s.getToken(),!s.token)return"/"}});const va=()=>{E.interceptors.request.use(t=>{if(t.url!=="/auth/token"){const s=R();s.token&&(t.headers.Authorization="Bearer "+s.token)}return t},t=>Promise.reject(t)),E.interceptors.response.use(t=>t,async t=>{const s=t.config;if(s.url!=="/auth/token"&&t.response&&t.response.status===401&&!s._retry){s._retry=!0;try{return await R().refreshToken(),E(s)}catch(n){return Promise.reject(n)}}return Promise.reject(t)})};d.useDefaults();d.setLevel(d.WARN);Ie.add(Te,Re,Ae,Pe,De,je,Me,Ne,Ke,Be,Ue,Ve,He,Fe,ze,We,Je,Ye,Ge,Xe,Ze,et,tt,st,nt,ot,at);it.watch();va();const H=rt(At);H.use(ct());H.use(qe);H.use(lt,pe);H.use(dt,ut({config:{classes:{input:"form-control",label:"form-label",help:"form-text",outer:"mb-3"}}}));H.use(_t);H.component("FontAwesomeIcon",ht);H.mount("#app");export{K as _};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/AboutView-BIVARLVw.js","assets/vendor-8hCdZR-U.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
