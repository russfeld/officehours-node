import{a as bt,d as O,u as _t,o as G,L as m,r as q,b as l,c,e as t,f as s,w as z,g as i,R as B,h as R,i as j,j as y,t as k,p as H,k as V,l as zt,S as $t,F as C,m as ut,s as S,n as at,q as Q,v as lt,x as A,y as P,z as X,A as F,B as W,C as Ct,M as st,D as ft,E as ht,G as dt,H as mt,I as xt,J as K,K as wt,N as tt,P as et,O as ot,_ as rt,Q as it,T as nt,U as qt,V as Mt,W as jt,X as St,Y as Et,Z as Qt,$ as Lt,a0 as It,a1 as At,a2 as Bt,a3 as Dt,a4 as Rt,a5 as Tt,a6 as Pt,a7 as Ot,a8 as Nt,a9 as Ut,aa as Kt,ab as Ht,ac as Vt,ad as Yt,ae as Ft,af as Wt,ag as Jt,ah as Zt,ai as Gt,aj as Xt,ak as te,al as ee,am as oe,an as re,ao as ie,ap as ne,aq as ae,ar as le,as as se,at as de,au as me}from"./vendor.0627cd51.js";const ce=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const p of a)if(p.type==="childList")for(const b of p.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&n(b)}).observe(document,{childList:!0,subtree:!0});function r(a){const p={};return a.integrity&&(p.integrity=a.integrity),a.referrerpolicy&&(p.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?p.credentials="include":a.crossorigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function n(a){if(a.ep)return;a.ep=!0;const p=r(a);fetch(a.href,p)}};ce();const M=bt.create({baseURL:"/",headers:{Accept:"application/json","Content-Type":"application/json"}}),L=O("token",{state:()=>({token:_t("token",""),sound:!0}),getters:{refresh_token(){return this.token?G(this.token).refresh_token:""},eid(){return this.token?G(this.token).eid:""},id(){return this.token?G(this.token).user_id:""},is_admin(){return this.token?G(this.token).is_admin:!1}},actions:{async getToken(){m.info("token:get"),await M.get("/auth/token",{withCredentials:!0}).then(e=>{this.token=e.data.token}).catch(e=>{e.response&&e.response.status===401?(m.info("token:get login failed - redirecting to CAS"),window.location.href="/auth/login"):(m.error("token:get error"+e),this.token="")})},async tryToken(){m.info("token:try"),await M.get("/auth/token",{withCredentials:!0}).then(e=>{this.token=e.data.token}).catch(async e=>{e.response&&e.response.status===401?(m.info("token:try login failed - trying refresh token"),await this.refreshToken()):(m.error("token:try error"+e),this.token="")})},async refreshToken(){m.info("token:refresh"),await M.post("/auth/token",{refresh_token:this.refresh_token}).then(e=>{this.token=e.data.token}).catch(e=>{e.response&&e.response.status===401?(m.info("token:refresh login failed - redirecting to CAS"),window.location.href="/auth/login"):(m.error("token:refresh error"+e),this.token="")})},async logout(){this.token="",window.location.href="/auth/logout"},async toggleSound(){this.sound=!this.sound}}});var T=(e,o)=>{const r=e.__vccOpts||e;for(const[n,a]of o)r[n]=a;return r};const pe=e=>(H("data-v-5f1a5e7f"),e=e(),V(),e),ge={class:"navbar navbar-expand-md navbar-dark fixed-top bg-purple"},be={class:"container"},ue=y("Office Hours"),fe=pe(()=>t("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarCollapse","aria-controls":"navbarCollapse","aria-expanded":"false","aria-label":"Toggle navigation"},[t("span",{class:"navbar-toggler-icon"})],-1)),he={id:"navbarCollapse",class:"collapse navbar-collapse"},xe={class:"navbar-nav me-auto mb-2 mb-md-0"},we={class:"nav-item"},ve=y("Queues"),ke={class:"nav-item"},ye=y("About"),_e={key:0,class:"nav-item"},ze=y("Admin"),$e={key:1,class:"nav-item"},Ce=y("Data"),qe={class:""},Me={key:0},je={class:"navbar-nav me-auto mb-2 mb-md-0"},Se={class:"nav-item"},Ee={class:"nav-item"},Qe={class:"nav-item"},Le=y(" Logout"),Ie={key:1},Ae=y(" Login"),Be={__name:"NavBar",setup(e){const o=L();return(r,n)=>{const a=q("font-awesome-icon");return l(),c("nav",ge,[t("div",be,[s(i(B),{to:"/",class:"navbar-brand"},{default:z(()=>[ue]),_:1}),fe,t("div",he,[t("ul",xe,[t("li",we,[s(i(B),{to:"/queues","active-class":"active",class:"nav-link"},{default:z(()=>[ve]),_:1})]),t("li",ke,[s(i(B),{to:"/about","active-class":"active",class:"nav-link"},{default:z(()=>[ye]),_:1})]),i(o).is_admin?(l(),c("li",_e,[s(i(B),{to:"/admin","active-class":"active",class:"nav-link"},{default:z(()=>[ze]),_:1})])):R("",!0),i(o).is_admin?(l(),c("li",$e,[s(i(B),{to:"/data","active-class":"active",class:"nav-link"},{default:z(()=>[Ce]),_:1})])):R("",!0)]),t("div",qe,[i(o).token?(l(),c("div",Me,[t("ul",je,[t("li",Se,[t("a",{class:"nav-link",onClick:n[0]||(n[0]=(...p)=>i(o).toggleSound&&i(o).toggleSound(...p))},[i(o).sound?(l(),j(a,{key:0,icon:"bell"})):(l(),j(a,{key:1,icon:"bell-slash"}))])]),t("li",Ee,[s(i(B),{to:"/profile","active-class":"active",class:"nav-link"},{default:z(()=>[s(a,{icon:"user"}),y(" "+k(i(o).eid),1)]),_:1})]),t("li",Qe,[t("a",{class:"btn btn-success float-end",onClick:n[1]||(n[1]=p=>i(o).logout())},[s(a,{icon:"arrow-right-from-bracket"}),Le])])])])):(l(),c("div",Ie,[t("a",{class:"btn btn-success",onClick:n[2]||(n[2]=p=>i(o).getToken())},[s(a,{icon:"arrow-right-to-bracket"}),Ae])]))])])])])}}};var De=T(Be,[["__scopeId","data-v-5f1a5e7f"]]);const Re={id:"main",class:"container px-4 py-5"},Te={__name:"App",setup(e){return(o,r)=>(l(),c(C,null,[t("header",null,[s(De)]),t("div",Re,[(l(),j($t,null,{default:z(()=>[s(i(zt))]),_:1}))])],64))}};var Pe=T(Te,[["__scopeId","data-v-68e3a569"]]);const Oe="modulepreload",gt={},Ne="/",Ue=function(o,r){return!r||r.length===0?o():Promise.all(r.map(n=>{if(n=`${Ne}${n}`,n in gt)return;gt[n]=!0;const a=n.endsWith(".css"),p=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${p}`))return;const b=document.createElement("link");if(b.rel=a?"stylesheet":Oe,a||(b.as="script",b.crossOrigin=""),b.href=n,document.head.appendChild(b),a)return new Promise((w,f)=>{b.addEventListener("load",w),b.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${n}`)))})})).then(()=>o())};const Ke={},He=e=>(H("data-v-193ed13f"),e=e(),V(),e),Ve={class:"pb-2 border-bottom"},Ye=y(" Office Hours Queue "),Fe=He(()=>t("div",{class:"row p-4 pb-0 pt-lg-4 pb-lg-4 align-items-center rounded-3 border shadow-lg"},[t("div",{class:"col-lg-10 mx-auto"},[t("p",{class:"lead-custom text-center"},[y(" Welcome! This site manages virtual queues for office hours."),t("br"),y("Let's get started! ")])])],-1));function We(e,o){const r=q("font-awesome-icon");return l(),c(C,null,[t("h2",Ve,[s(r,{icon:"chalkboard-teacher"}),Ye]),Fe],64)}var Je=T(Ke,[["render",We],["__scopeId","data-v-193ed13f"]]);const Ze=t("br",null,null,-1),Ge={key:0},Xe=y("Click Here to See Available Queues"),to={key:1},eo=y(" Login"),oo={__name:"LoginMessage",setup(e){const o=L();return(r,n)=>{const a=q("RouterLink"),p=q("font-awesome-icon");return l(),c("main",null,[s(Je),Ze,i(o).token?(l(),c("div",Ge,[s(a,{to:"/queues",class:"btn btn-success"},{default:z(()=>[Xe]),_:1})])):(l(),c("div",to,[t("a",{class:"btn btn-success",onClick:n[0]||(n[0]=b=>i(o).getToken())},[s(p,{icon:"arrow-right-to-bracket"}),eo])]))])}}},ro={__name:"HomeView",setup(e){return(o,r)=>(l(),j(oo))}};const io={},no=e=>(H("data-v-5250f3b6"),e=e(),V(),e),ao={class:"pb-2 border-bottom"},lo=y(" Office Hours Queue "),so=no(()=>t("div",{class:"row p-4 pb-0 pt-lg-4 pb-lg-4 align-items-center rounded-3 border shadow-lg"},[t("div",{class:"col-lg-10 mx-auto"},[t("p",{class:"lead-custom text-center"}," Select a queue to join: ")])],-1));function mo(e,o){const r=q("font-awesome-icon");return l(),c(C,null,[t("h2",ao,[s(r,{icon:"chalkboard-teacher"}),lo]),so],64)}var co=T(io,[["render",mo],["__scopeId","data-v-5250f3b6"]]);const I=O("queues",{state:()=>({queues:[],online:[],socket:void 0,connected:!1,error:!1}),getters:{getQueue:e=>o=>e.queues.find(r=>r.id==o),getOnline:e=>o=>e.online.find(r=>r.id==o)||{is_open:!1,helpers:0,requests:0},sortedQueues:e=>[...e.queues].sort((o,r)=>r.is_open-o.is_open)},actions:{async hydrate(){m.info("queues:hydrate"),await M.get("/api/v1/queues").then(e=>{this.queues=e.data})},async hydrateOnline(){m.info("queues:hydrateOnline"),this.socket&&(this.socket.disconnect(),this.online={});const e=L(),o="/status";this.socket=ut(o,{auth:{token:e.token}}),this.socket.on("connect",()=>{m.info("socket:connect"),this.connected=!0,this.error=!1}),this.socket.on("connect_error",r=>{m.error("socket:connect_error - "+r),this.$reset,this.error=!0}),this.socket.on("disconnect",()=>{m.info("socket:disconnect"),this.connected=!1,this.error=!1}),this.socket.on("status:update",async r=>{m.info("status:update - "+r.id),m.debug("|- updated: "+r);var n=this.online.findIndex(a=>a.id===r.id);n<0?this.online.push(r):Object.assign(this.online[n],r)}),m.info("emit status:connect"),await this.socket.emit("status:connect",async(r,n)=>{r==200?(m.info("status:connect OK"),m.debug("|- online: "+n),this.online=n):m.error("status:connect error - "+r)})},async disconnectQueue(){this.socket&&(m.info("emit socket:disconnect"),this.socket.disconnect()),this.$reset()},async update(e){await M.post("/api/v1/queues/"+e.id,{queue:e}).then(async()=>{await this.hydrate()})},async deleteQueue(e){await M.delete("/api/v1/queues/"+e).then(async()=>{await this.hydrate()})},async addQueue(e){await M.put("/api/v1/queues/",{name:e}).then(async()=>{await this.hydrate()})}}});const po={class:"col"},go={class:"card-header"},bo={key:0,class:"float-end badge rounded-pill bg-success"},uo={key:1,class:"float-end badge rounded-pill bg-danger"},fo={class:"card-body"},ho={class:"card-text"},xo={__name:"QueueCard",props:{queue:{type:Object,default(){return{}}}},setup(e){const o=e,r=I(),{getOnline:n}=S(r),a=at();function p(b){a.push("/queues/"+b)}return(b,w)=>{const f=q("font-awesome-icon");return l(),c("div",po,[t("div",{class:"card w-100 hvr-grow",onClick:w[0]||(w[0]=h=>p(o.queue.id))},[t("h5",go,[y(k(o.queue.name)+" ",1),i(n)(o.queue.id).is_open===1?(l(),c("span",bo,[y("Open | "+k(i(n)(o.queue.id).helpers||0)+" ",1),s(f,{icon:"user-graduate"}),y(" | "+k(i(n)(o.queue.id).requests||0)+" ",1),s(f,{icon:"circle-question"})])):(l(),c("span",uo,"Closed"))]),t("div",fo,[t("p",ho,k(o.queue.snippet),1)])])])}}};var wo=T(xo,[["__scopeId","data-v-3228e55c"]]);const vo={class:"row row-cols-1 row-cols-lg-3 g-4"},ko={__name:"QueueList",async setup(e){let o,r;const n=I();n.hydrate(),[o,r]=Q(()=>n.hydrateOnline()),await o,r();const{sortedQueues:a}=S(n);return lt(async()=>{await n.disconnectQueue()}),(p,b)=>(l(),c("div",vo,[(l(!0),c(C,null,A(i(a),(w,f)=>(l(),j(wo,{key:w.id,queue:w,index:f},null,8,["queue","index"]))),128))]))}},yo=t("br",null,null,-1),_o={__name:"QueueListView",setup(e){return(o,r)=>(l(),c("main",null,[s(co),yo,s(ko)]))}},J=O("requests",{state:()=>({requests:[],online:[],helpers:[],socket:void 0,connected:!1,error:!1}),getters:{getRequest:e=>o=>e.requests.find(r=>r.user_id===o),userOnline:e=>o=>e.online.find(r=>r==o)!==void 0,sortedRequests:e=>[...e.requests].sort(function(o,r){return o.status_id==r.status_id?o.id-r.id:r.status_id-o.status_id})},actions:{async connectQueue(e){this.socket&&this.socket.disconnect(),this.$reset();const o=L(),r="/";this.socket=ut(r,{auth:{token:o.token,queue_id:e}}),this.socket.on("connect",()=>{m.info("socket:connect"),this.connected=!0,this.error=!1}),this.socket.on("connect_error",n=>{m.error("socket:connect_error - "+n),this.$reset,this.error=!0}),this.socket.on("disconnect",()=>{m.info("socket:disconnect"),this.connected=!1,this.error=!1}),this.socket.on("queue:update",async n=>{m.info("queue:update - "+n.id),m.debug("|- updated: "+n);var a=this.requests.findIndex(p=>p.id===n.id);a<0?(this.requests.push(n),o.sound&&new Audio("/ding-36029.mp3").play()):this.requests[a]=n}),this.socket.on("queue:remove",async n=>{m.info("queue.remove - "+n);var a=this.requests.findIndex(p=>p.id===n);a>=0&&this.requests.splice(a,1)}),this.socket.on("user:online",async n=>{m.info("user:online - "+n),this.online.push(String(n))}),this.socket.on("user:offline",async n=>{m.info("user:offline - "+n),this.online.splice(this.online.indexOf(String(n)),1)}),this.socket.on("helper:online",async n=>{m.info("helper:online - "+n.id),m.debug("|- helper: "+n),this.helpers.push(n)}),this.socket.on("helper:offline",async n=>{m.info("helper:offline - "+n),this.helpers.splice(this.helpers.findIndex(a=>a.id==n),1)}),this.socket.on("queue:opening",async()=>{m.info("queue:opening"),await I().hydrate()}),this.socket.on("connected",async(n,a)=>{m.info("socket:connected"),m.debug("|-online: "+n),m.debug("|-helpers: "+a),this.online=n,this.helpers=a}),this.socket.on("queue:closing",async()=>{m.info("queue:closing"),this.requests=[],await I().hydrate()}),m.info("emit queue:connect"),await this.socket.emit("queue:connect",async(n,a)=>{n==200?(m.info("queue:connect OK"),m.debug("|- requests: "+a),this.requests=a):m.error("queue:connect error - "+n)})},async disconnectQueue(){this.socket&&(m.info("emit socket:disconnect"),this.socket.disconnect()),this.$reset()},async joinQueue(){m.info("emit queue:join"),await this.socket.emit("queue:join",async e=>{e==200?m.info("queue:join OK"):m.error("queue:join error - "+e)})},async openQueue(){m.info("emit queue:open"),await this.socket.emit("queue:open",async e=>{e==200?(m.info("queue:open OK"),I().hydrate()):m.error("queue:open error - "+e)})},async closeQueue(){m.info("emit queue:close"),await this.socket.emit("queue:close",async e=>{e==200?(m.info("queue:close OK"),this.requests=[],I().hydrate()):m.error("queue:close error - "+e)})},async takeRequest(e){m.info("emit request:take - "+e),await this.socket.emit("request:take",e,async o=>{o==200?m.info("request:take OK"):m.error("request:take error - "+o)})},async deleteRequest(e){m.info("emit request:delete - "+e),await this.socket.emit("request:delete",e,async o=>{o==200?m.info("request:delete OK"):m.error("request:delete error - "+o)})},async finishRequest(e){m.info("emit request:finish - "+e),await this.socket.emit("request:finish",e,async o=>{o==200?m.info("request:finish OK"):m.error("request:finish error - "+o)})},async requeueRequest(e){m.info("emit request:requeue - "+e),await this.socket.emit("request:requeue",e,async o=>{o==200?m.info("request:requeue OK"):m.error("request:requeue error - "+o)})}}});const zo=e=>(H("data-v-651444a6"),e=e(),V(),e),$o={key:2,class:"badge bg-primary rounded-pill"},Co=zo(()=>t("br",null,null,-1)),qo={id:"tooltip",class:"text-muted"},Mo={__name:"RequestItem",props:{request:{type:Object,default(){return{}}},helper:{type:Boolean,default(){return!1}},userId:{type:Number,default(){return-1}}},setup(e){const o=e;var r=P({now:X.utc()});const n=function(){r.now=X.utc(),setInterval(n,1e4)};setInterval(n,1e4);const a=J(),p=async function(){await a.deleteRequest(o.request.id)},b=async function(){await a.takeRequest(o.request.id)},w=async function(){await a.finishRequest(o.request.id)},f=async function(){await a.requeueRequest(o.request.id)},h=F(()=>o.request.updated_at?r.now.to(o.request.updated_at):r.now.to(o.request.created_at));return(x,u)=>{const d=q("font-awesome-icon");return l(),c("li",{class:W(["list-group-item",[e.request.status_id==2?"list-group-item-primary":"",e.request.user_id==e.userId?"current-user":"",i(a).userOnline(e.request.user_id)?"":"list-group-item-light"]])},[i(a).userOnline(e.request.user_id)?(l(),j(d,{key:0,icon:"link"})):(l(),j(d,{key:1,icon:"link-slash"})),y(" "+k(e.request.user.name)+" ",1),e.helper?(l(),c(C,{key:2},[t("button",{class:"float-end btn btn-danger btn-sm mx-1",onClick:p},[s(d,{icon:"times",size:"xl"})]),t("button",{class:"float-end btn btn-secondary btn-sm mx-1",onClick:f},[s(d,{icon:"redo",size:"lg"})]),e.request.status_id==1?(l(),c("button",{key:0,class:"float-end btn btn-primary btn-sm mx-1",onClick:b}," Take ")):(l(),c("button",{key:1,class:"float-end btn btn-success btn-sm mx-1",onClick:w}," Done ")),e.request.status_id==2?(l(),c("span",$o,k(e.request.helper.name),1)):R("",!0),Co,t("small",qo,k(i(h)),1)],64)):R("",!0)],2)}}};var jo=T(Mo,[["__scopeId","data-v-651444a6"]]);const So=t("h3",{class:"text-center"},"Students Waiting",-1),Eo=t("hr",null,null,-1),Qo={class:"list-group list-group-numbered"},vt={__name:"RequestList",props:{id:{type:Number,default:-1}},setup(e){const o=L(),r=J(),{sortedRequests:n}=S(r);return(a,p)=>(l(),c(C,null,[So,Eo,t("ul",Qo,[(l(!0),c(C,null,A(i(n),(b,w)=>(l(),j(jo,Ct({key:b.id,request:b,index:w},a.$attrs,{"user-id":i(o).id}),null,16,["request","index","user-id"]))),128))])],64))}},Lo=t("h3",{class:"text-center"},"Helpers Online",-1),Io=t("hr",null,null,-1),Ao={class:"list-group list-group-flush"},kt={__name:"HelperList",setup(e){const o=J(),{helpers:r}=S(o);return(n,a)=>{const p=q("font-awesome-icon");return l(),c(C,null,[Lo,Io,t("ul",Ao,[(l(!0),c(C,null,A(i(r),(b,w)=>(l(),c("li",{key:w,class:"list-group-item"},[s(p,{icon:"link"}),y(" "+k(b.name),1)]))),128))])],64)}}};const Y=e=>(H("data-v-38a96dbb"),e=e(),V(),e),Bo={class:"queue-header mx-auto"},Do={key:0,class:"btn btn-outline-success float-end disabled"},Ro=Y(()=>t("span",{class:"visually-hidden"},"Connected!",-1)),To=Y(()=>t("span",{class:"visually-hidden"},"Disconnected!",-1)),Po=Y(()=>t("span",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},null,-1)),Oo=Y(()=>t("span",{class:"visually-hidden"},"Connecting...",-1)),No=[Po,Oo],Uo=Y(()=>t("h2",{class:"text-center"},"Moderate Queue",-1)),Ko=Y(()=>t("hr",null,null,-1)),Ho={class:"row"},Vo={class:"col-12 col-md-4 mb-4"},Yo={class:"col-12 col-md-8 mb-4"},Fo={__name:"HelperPane",props:{id:{type:Number,default:-1}},async setup(e){let o,r;const n=e,a=I();[o,r]=Q(()=>a.hydrate()),await o,r();const p=a.getQueue,b=J(),{connected:w,error:f}=S(b);[o,r]=Q(()=>b.connectQueue(n.id)),await o,r();const h=async function(){confirm("Are you sure? All pending requests will be lost!")&&await b.closeQueue()},x=async function(){await b.openQueue()},u=async function(){await b.connectQueue(n.id)};return lt(async()=>{await b.disconnectQueue()}),(d,g)=>{const v=q("font-awesome-icon");return l(),c(C,null,[t("div",Bo,[i(w)?(l(),c("button",Do,[s(v,{icon:"link"}),Ro])):(l(),c(C,{key:1},[i(f)?(l(),c("button",{key:0,class:"btn btn-outline-danger float-end",onClick:u},[s(v,{icon:"link-slash"}),To])):(l(),c("button",{key:1,class:"btn btn-outline-warning float-end",onClick:u},No))],64)),Uo,i(p)(e.id).is_open==1?(l(),c("a",{key:2,class:"w-100 btn btn-success",onClick:h},"Queue is Open - Click to Close")):(l(),c("a",{key:3,class:"w-100 btn btn-danger",onClick:x},"Queue is Closed - Click to Open"))]),Ko,t("div",Ho,[t("div",Vo,[s(kt)]),t("div",Yo,[s(vt,{id:e.id,helper:""},null,8,["id"])])])],64)}}};var Wo=T(Fo,[["__scopeId","data-v-38a96dbb"]]);const D=e=>(H("data-v-3eaf00d9"),e=e(),V(),e),Jo={id:"studentModal",class:"modal fade",tabindex:"-1","aria-labelledby":"studentModalLabel","aria-hidden":"true"},Zo={class:"modal-dialog"},Go={class:"modal-content"},Xo=D(()=>t("div",{class:"modal-header"},[t("h5",{id:"studentModalLabel",class:"modal-title"},"Your Turn!"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),tr={class:"modal-body"},er=y(" You will be helped by "),or=y(". Their contact info is below: "),rr=D(()=>t("hr",null,null,-1)),ir=["innerHTML"],nr=D(()=>t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," OK ")],-1)),ar={class:"queue-header mx-auto"},lr={key:0,class:"btn btn-outline-success float-end disabled"},sr=D(()=>t("span",{class:"visually-hidden"},"Connected!",-1)),dr=D(()=>t("span",{class:"visually-hidden"},"Disconnected!",-1)),mr=D(()=>t("span",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},null,-1)),cr=D(()=>t("span",{class:"visually-hidden"},"Connecting...",-1)),pr=[mr,cr],gr=D(()=>t("h2",{class:"text-center"},"Waiting Queue",-1)),br={key:0,class:"w-100 btn btn-success disabled",disabled:""},ur={key:3,class:"w-100 btn btn-danger disabled",disabled:""},fr=D(()=>t("hr",null,null,-1)),hr={key:0,class:"row"},xr={class:"col-12 col-md-4 mb-4"},wr={class:"col-12 col-md-8 mb-4"},vr={__name:"StudentPane",props:{id:{type:Number,default:-1}},async setup(e){let o,r;const n=e,a=L(),p=I();[o,r]=Q(()=>p.hydrate()),await o,r();const b=p.getQueue,w=J(),f=w.getRequest,{connected:h,error:x}=S(w);[o,r]=Q(()=>w.connectQueue(n.id)),await o,r();var u,d=!1;w.$subscribe(()=>{const $=f(a.id);$&&$.status_id==2&&!d&&(d=!0,u=new st("#studentModal",{}),u.show(),a.sound&&new Audio("/ding-36029.mp3").play()),$||(d=!1)});const g=async function(){d=!1,await w.joinQueue()},v=async function(){await w.connectQueue(n.id)};return lt(async()=>{await w.disconnectQueue()}),($,_)=>{const E=q("font-awesome-icon");return l(),c(C,null,[t("div",Jo,[t("div",Zo,[t("div",Go,[Xo,t("div",tr,[i(f)(i(a).id)&&i(f)(i(a).id).helper?(l(),c(C,{key:0},[t("p",null,[er,t("strong",null,k(i(f)(i(a).id).helper.name),1),or]),rr,t("div",{innerHTML:i(ft).sanitize(i(ht).parse(i(f)(i(a).id).helper.contact_info||""))},null,8,ir)],64)):R("",!0)]),nr])])]),t("div",ar,[i(h)?(l(),c("button",lr,[s(E,{icon:"link"}),sr])):(l(),c(C,{key:1},[i(x)?(l(),c("button",{key:0,class:"btn btn-outline-danger float-end",onClick:v},[s(E,{icon:"link-slash"}),dr])):(l(),c("button",{key:1,class:"btn btn-outline-warning float-end",onClick:v},pr))],64)),gr,i(b)(e.id).is_open==1?(l(),c(C,{key:2},[i(f)(i(a).id)!=null?(l(),c("a",br,"Queue Joined")):(l(),c("a",{key:1,class:"w-100 btn btn-success",onClick:_[0]||(_[0]=Z=>g())},"Join Queue"))],64)):(l(),c("a",ur,"Queue is Closed"))]),fr,i(b)(e.id).is_open==1?(l(),c("div",hr,[t("div",xr,[s(kt)]),t("div",wr,[s(vt,{id:e.id},null,8,["id"])])])):R("",!0)],64)}}};var kr=T(vr,[["__scopeId","data-v-3eaf00d9"]]);const yr=y(" Back"),_r=y(" Edit"),zr={class:"display-5 text-center"},$r=t("hr",null,null,-1),Cr=["innerHTML"],qr=t("hr",null,null,-1),Mr={__name:"QueueSingle",props:{id:{type:Number,default:-1}},async setup(e){let o,r;const n=L(),a=I();[o,r]=Q(()=>a.hydrate()),await o,r();const p=a.getQueue;return(b,w)=>{const f=q("font-awesome-icon");return l(),c("main",null,[s(i(B),{to:{name:"queues"},class:"btn btn-secondary float-start"},{default:z(()=>[s(f,{icon:"arrow-left"}),yr]),_:1}),i(n).is_admin?(l(),j(i(B),{key:0,to:{name:"queue_edit",params:{id:e.id}},class:"btn btn-secondary float-end"},{default:z(()=>[s(f,{icon:"pen-to-square"}),_r]),_:1},8,["to"])):R("",!0),t("h1",zr,k(i(p)(e.id).name),1),$r,t("div",{innerHTML:i(ft).sanitize(i(ht).parse(i(p)(e.id).description||""))},null,8,Cr),qr,i(p)(e.id).helper==1?(l(),j(Wo,{key:1,id:e.id},null,8,["id"])):(l(),j(kr,{key:2,id:e.id},null,8,["id"]))])}}},jr={__name:"QueueSingleView",setup(e){return(o,r)=>(l(),j(Mr))}},ct=O("users",{state:()=>({users:[]}),getters:{getUser:e=>o=>e.users.find(r=>r.id===o)},actions:{async hydrate(){m.info("users:hydrate"),await M.get("/api/v1/users").then(e=>{this.users=e.data})},async update(e){await M.post("/api/v1/users/"+e.id,{user:e}).then(async()=>{await this.hydrate()})},async deleteUser(e){await M.delete("/api/v1/users/"+e).then(async()=>{await this.hydrate()})},async addUser(e){await M.put("/api/v1/users/",{eid:e}).then(async()=>{await this.hydrate()})}}});const Sr=t("h1",{class:"display-5 text-center"},"Edit Queue",-1),Er=t("hr",null,null,-1),Qr={class:"mb-3"},Lr=t("label",{for:"multiselect-users",class:"form-label"},"Helpers",-1),Ir=t("div",{class:"form-text"}," Helpers who can manage the queue (usually TAs) - admins already have access ",-1),Ar={class:"row row-cols-1 row-cols-md-2"},Br=t("div",{class:"col d-grid mb-2"},[t("button",{class:"btn btn-success"},"Save")],-1),Dr={class:"col d-grid mb-2"},Rr=y(" Cancel"),Tr=y(" Cancel"),Pr={__name:"EditQueue",props:{id:{type:Number,default:-1},admin:{type:Boolean,default:!1}},async setup(e){let o,r;const n=e,a=at(),p=I();[o,r]=Q(()=>p.hydrate()),await o,r();const b=p.getQueue(n.id),w=ct();w.hydrate();const{users:f}=S(w);var h;dt(()=>{h=new mt({autoDownloadFontAwesome:!1,blockStyles:{italic:"_"},status:!1,spellChecker:!1})});const x=async u=>{u=(({id:d,name:g,snippet:v})=>({id:d,name:g,snippet:v}))(u),u.description=h.value(),u.users=[];for(const d of b.users)u.users.push({id:d.id});try{await p.update(u),n.admin?a.push("/admin"):a.push("/queues/"+b.id)}catch(d){if(d.response&&d.response.status===422){let g={};if(d.response.data.data){for(const v in d.response.data.data){g[v]="";for(const $ of d.response.data.data[v])g[v]=g[v]+$.message+" "}K("queueform",["The server rejected this submission. Please correct errors listed above"],g)}else K("queueform",["The server rejected this submission due to an SQL Error. Refresh and try again"])}else console.error(d)}};return(u,d)=>{const g=q("FormKit"),v=q("router-link");return l(),c("main",null,[Sr,Er,s(g,{id:"queueform",type:"form",value:i(b),actions:!1,onSubmit:x},{default:z(()=>[s(g,{type:"text",name:"name",label:"Queue Name",help:"Name of the queue (usually the course)",validation:"required"}),s(g,{type:"text",name:"snippet",label:"Short Description",help:"Short description shown on the initial card"}),s(g,{type:"textarea",name:"description",label:"Long Description",help:"Long description shown on the queue page",rows:"10"}),t("div",Qr,[Lr,s(i(xt),{id:"multiselect-users",modelValue:i(b).users,"onUpdate:modelValue":d[0]||(d[0]=$=>i(b).users=$),class:"form-control",options:i(f),multiple:!0,"tag-placeholder":"Add this as new user",placeholder:"Type to search or add user",label:"eid","track-by":"id"},null,8,["modelValue","options"]),Ir]),t("div",Ar,[Br,t("div",Dr,[e.admin?(l(),j(v,{key:0,to:{name:"admin"},class:"btn btn-secondary"},{default:z(()=>[Rr]),_:1})):(l(),j(v,{key:1,to:{name:"queue_single",params:{id:i(b).id}},class:"btn btn-secondary"},{default:z(()=>[Tr]),_:1},8,["to"]))])])]),_:1},8,["value"])])}}},Or={__name:"QueueEditView",setup(e){return(o,r)=>(l(),j(Pr))}},Nr=O("profile",{state:()=>({user:{}}),actions:{async hydrate(){m.info("profile:hydrate"),await M.get("/api/v1/profile").then(e=>{this.user=e.data})},async update(e){await M.post("/api/v1/profile/",{user:e}).then(async()=>{await this.hydrate()})}}});const Ur=t("h1",{class:"display-5 text-center"},"Edit User",-1),Kr=t("hr",null,null,-1),Hr={class:"row row-cols-1 row-cols-md-2"},Vr=t("div",{class:"col d-grid mb-2"},[t("button",{class:"btn btn-success"},"Save")],-1),Yr={class:"col d-grid mb-2"},Fr=y(" Cancel"),Wr={__name:"EditProfile",async setup(e){let o,r;const n=at(),a=Nr();[o,r]=Q(()=>a.hydrate()),await o,r();const{user:p}=S(a);var b;dt(()=>{b=new mt({autoDownloadFontAwesome:!1,blockStyles:{italic:"_"},status:!1,spellChecker:!1})});const w=async f=>{const h={name:f.name,contact_info:b.value()};try{await a.update(h),n.push("/queues/")}catch(x){if(x.response&&x.response.status===422){let u={};if(x.response.data.data){for(const d in x.response.data.data){u[d]="";for(const g of x.response.data.data[d])u[d]=u[d]+g.message+" "}K("userform",["The server rejected this submission. Please correct errors listed above"],u)}else K("userform",["The server rejected this submission due to an SQL Error. Refresh and try again"])}else console.error(x)}};return(f,h)=>{const x=q("FormKit"),u=q("router-link");return l(),c("main",null,[Ur,Kr,s(x,{id:"userform",type:"form",value:i(p),actions:!1,onSubmit:w},{default:z(()=>[s(x,{type:"text",name:"eid",label:"eID",disabled:!0,help:"Your K-State eID (cannot be changed)",validation:"required"}),s(x,{type:"text",name:"name",label:"Name",help:"Your full name as you'd like it displayed on the site",validation:"required"}),s(x,{type:"textarea",name:"contact_info",label:"Contact Information",help:"Any information we should know about how to contact you",rows:"10"}),t("div",Hr,[Vr,t("div",Yr,[s(u,{to:{name:"queues"},class:"btn btn-secondary"},{default:z(()=>[Fr]),_:1})])])]),_:1},8,["value"])])}}};const Jr={__name:"ProfileView",setup(e){return(o,r)=>(l(),j(Wr))}},Zr={id:"userModal",class:"modal fade",tabindex:"-1","aria-labelledby":"userModalLabel","aria-hidden":"true"},Gr={class:"modal-dialog"},Xr={class:"modal-content"},ti=t("div",{class:"modal-header"},[t("h5",{id:"userModalLabel",class:"modal-title"},"Delete User"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),ei={class:"modal-body"},oi=t("h5",null,"Are you sure you want to delete this user?",-1),ri=t("strong",null,"eID: ",-1),ii=t("br",null,null,-1),ni=t("strong",null,"Name: ",-1),ai={class:"modal-footer"},li=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1),si=y(" Delete User "),di=y(" User "),mi=t("h1",{class:"text-center"},"Users",-1),ci={class:"table table-striped table-hover"},pi=t("thead",null,[t("tr",null,[t("th",null,"eID"),t("th",null,"Name"),t("th",null,"Roles"),t("th",null,"Actions")])],-1),gi=["onClick"],bi={__name:"UserAdmin",setup(e){const o=ct();o.hydrate();const{users:r}=S(o),n=L();var a=P({}),p;const b=function(h){a.id=h.id,a.eid=h.eid,a.name=h.name,p=new st("#userModal",{}),p.show()},w=async function(h){await o.deleteUser(h),p.hide()},f=async function(){var h=prompt("Enter an eID to create a user");if(h)try{await o.addUser(h)}catch(x){x.response&&x.response.status===422?alert(JSON.stringify(x.response.data)):alert(x)}};return(h,x)=>{const u=q("font-awesome-icon");return l(),c(C,null,[t("div",Zr,[t("div",Gr,[t("div",Xr,[ti,t("div",ei,[oi,t("p",null,[ri,y(k(i(a).eid)+" ",1),ii,ni,y(k(i(a).name),1)])]),t("div",ai,[li,t("button",{type:"button",class:"btn btn-danger",onClick:x[0]||(x[0]=d=>w(i(a).id))},[s(u,{icon:"trash"}),si])])])])]),t("button",{type:"button",class:"btn btn-success float-end",onClick:f},[s(u,{icon:"plus"}),di]),mi,t("table",ci,[pi,t("tbody",null,[(l(!0),c(C,null,A(i(r),d=>(l(),c("tr",{key:d.id},[t("td",null,k(d.eid),1),t("td",null,k(d.name),1),t("td",null,[(l(!0),c(C,null,A(d.roles,g=>(l(),c("span",{key:g.id,class:"badge rounded-pill bg-success"},k(g.name),1))),128))]),t("td",null,[s(i(B),{to:{name:"admin_useredit",params:{id:d.id}},class:"btn btn-secondary btn-sm mx-1"},{default:z(()=>[s(u,{icon:"pen-to-square"})]),_:2},1032,["to"]),d.id!=i(n).id?(l(),c("button",{key:0,type:"button",class:"btn btn-danger btn-sm mx-1",onClick:wt(g=>b(d),["prevent"])},[s(u,{icon:"trash"})],8,gi)):R("",!0)])]))),128))])])],64)}}},ui={id:"queueModal",class:"modal fade",tabindex:"-1","aria-labelledby":"queueModalLabel","aria-hidden":"true"},fi={class:"modal-dialog"},hi={class:"modal-content"},xi=t("div",{class:"modal-header"},[t("h5",{id:"queueModalLabel",class:"modal-title"},"Delete Queue"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),wi={class:"modal-body"},vi=t("h5",null,"Are you sure you want to delete this queue?",-1),ki=t("strong",null,"Name: ",-1),yi={class:"modal-footer"},_i=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1),zi=y(" Delete Queue "),$i=y(" Queue "),Ci=t("h1",{class:"text-center"},"Queues",-1),qi={class:"table table-striped table-hover"},Mi=t("thead",null,[t("tr",null,[t("th",null,"Name"),t("th",null,"Actions")])],-1),ji=["onClick"],Si={__name:"QueueAdmin",setup(e){const o=I();o.hydrate();const{queues:r}=S(o);var n=P({}),a;const p=function(f){n.id=f.id,n.name=f.name,a=new st("#queueModal",{}),a.show()},b=async function(f){await o.deleteQueue(f),a.hide()},w=async function(){var f=prompt("Enter a name for the new queue");if(f)try{await o.addQueue(f)}catch(h){h.response&&h.response.status===422?alert(JSON.stringify(h.response.data)):alert(h)}};return(f,h)=>{const x=q("font-awesome-icon"),u=q("router-link");return l(),c(C,null,[t("div",ui,[t("div",fi,[t("div",hi,[xi,t("div",wi,[vi,t("p",null,[ki,y(k(i(n).name),1)])]),t("div",yi,[_i,t("button",{type:"button",class:"btn btn-danger",onClick:h[0]||(h[0]=d=>b(i(n).id))},[s(x,{icon:"trash"}),zi])])])])]),t("button",{type:"button",class:"btn btn-success float-end",onClick:w},[s(x,{icon:"plus"}),$i]),Ci,t("table",qi,[Mi,t("tbody",null,[(l(!0),c(C,null,A(i(r),d=>(l(),c("tr",{key:d.id},[t("td",null,k(d.name),1),t("td",null,[s(u,{to:{name:"queue_edit",params:{id:d.id,admin:!0}},class:"btn btn-secondary btn-sm mx-1"},{default:z(()=>[s(x,{icon:"pen-to-square"})]),_:2},1032,["to"]),t("button",{type:"button",class:"btn btn-danger btn-sm mx-1",onClick:wt(g=>p(d),["prevent"])},[s(x,{icon:"trash"})],8,ji)])]))),128))])])],64)}}},Ei={__name:"AdminView",setup(e){return(o,r)=>(l(),c(C,null,[s(Si),s(bi)],64))}},Qi=O("roles",{state:()=>({roles:[]}),actions:{async hydrate(){m.info("roles:hydrate"),await M.get("/api/v1/roles").then(e=>{this.roles=e.data})}}});const Li=t("h1",{class:"display-5 text-center"},"Edit User",-1),Ii=t("hr",null,null,-1),Ai={class:"mb-3"},Bi=t("label",{for:"multiselect-roles",class:"form-label"},"Roles",-1),Di=t("div",{class:"form-text"},"Roles assigned to this user",-1),Ri={class:"row row-cols-1 row-cols-md-2"},Ti=t("div",{class:"col d-grid mb-2"},[t("button",{class:"btn btn-success"},"Save")],-1),Pi={class:"col d-grid mb-2"},Oi=y(" Cancel"),Ni={__name:"UserEdit",props:{id:{type:Number,default:-1}},async setup(e){let o,r;const n=e,a=at(),p=ct();[o,r]=Q(()=>p.hydrate()),await o,r();const b=p.users.find(u=>u.id===parseInt(n.id)),w=Qi();w.hydrate();const{roles:f}=S(w);var h;dt(()=>{h=new mt({autoDownloadFontAwesome:!1,blockStyles:{italic:"_"},status:!1,spellChecker:!1})});const x=async u=>{u=(({id:d,name:g})=>({id:d,name:g}))(u),u.contact_info=h.value(),u.roles=[];for(const d of b.roles)u.roles.push({id:d.id});try{await p.update(u),a.push("/admin/")}catch(d){if(d.response&&d.response.status===422){let g={};if(d.response.data.data){for(const v in d.response.data.data){g[v]="";for(const $ of d.response.data.data[v])g[v]=g[v]+$.message+" "}K("usersForm",["The server rejected this submission. Please correct errors listed above"],g)}else K("usersForm",["The server rejected this submission due to an SQL Error. Refresh and try again"])}else console.error(d)}};return(u,d)=>{const g=q("FormKit"),v=q("router-link");return l(),c("main",null,[Li,Ii,s(g,{id:"userform",type:"form",value:i(b),actions:!1,onSubmit:x},{default:z(()=>[s(g,{type:"text",name:"eid",label:"eID",disabled:!0,help:"The user's K-State eID (cannot be changed)",validation:"required"}),s(g,{type:"text",name:"name",label:"Name",help:"The user's full name as you'd like it displayed on the site",validation:"required"}),s(g,{type:"textarea",name:"contact_info",label:"Contact Information",help:"Any information we should know about how to contact the user",rows:"10"}),t("div",Ai,[Bi,s(i(xt),{id:"multiselect-roles",modelValue:i(b).roles,"onUpdate:modelValue":d[0]||(d[0]=$=>i(b).roles=$),class:"form-control",options:i(f),multiple:!0,"tag-placeholder":"Add this as new role",placeholder:"Type to search or add role",label:"name","track-by":"id"},null,8,["modelValue","options"]),Di]),t("div",Ri,[Ti,t("div",Pi,[s(v,{to:{name:"admin"},class:"btn btn-secondary"},{default:z(()=>[Oi]),_:1})])])]),_:1},8,["value"])])}}},Ui={__name:"UserEditView",setup(e){return(o,r)=>(l(),j(Ni))}},pt=O("periods",{state:()=>({queues:[],periods:[],events:[],presences:[]}),getters:{getPeriod:e=>o=>e.periods.find(r=>r.id==o)},actions:{async hydrate(){m.info("periods:hydrate"),await M.get("/api/v1/periods").then(e=>{this.queues=e.data})},async loadPeriods(e){m.info("periods:hydrate - "+e),await M.get("/api/v1/periods?name="+e).then(o=>{this.periods=o.data})},async loadEvents(e){m.info("periods:hydrate - "+e),await M.get("/api/v1/periods/"+e).then(o=>{this.events=o.data.events;for(var r of this.events)r.ganttBarConfig={id:r.id},r.created_at=X(r.created_at).format("YYYY-MM-DD HH:mm"),r.updated_at=X(r.updated_at).format("YYYY-MM-DD HH:mm");this.presences=o.data.presences})}}});const Ki=t("h1",{class:"display-5 text-center"},"Event Log: Queues",-1),Hi=["data-page-count"],Vi={class:"col-md-6 mb-2 mb-md-0"},Yi={class:"col-md-6"},Fi={class:"row"},Wi={class:"col-md-12"},Ji={class:"table-responsive"},Zi={class:"table table-striped d-md-table"},Gi=["onClick"],Xi=t("i",{class:"gg-select float-right"},null,-1),tn=t("th",null,"Actions",-1),en=y("View"),on={class:"d-flex flex-md-row flex-column justify-content-between align-items-center"},rn={__name:"QueueList",async setup(e){let o,r;const n=pt();[o,r]=Q(()=>n.hydrate()),await o,r();const{queues:a}=S(n),p=P([{name:"Queue",field:"queue_name",sort:""},{name:"Periods",field:"periods",sort:""},{name:"Recent",field:"recent",sort:""}]),b=function(f,h){let x;const u=p[h];f.shiftKey||this.cols.forEach(d=>{d.field!==u.field&&(d.sort="")}),u.sort||(x="asc"),u.sort==="desc"&&(x=f.shiftKey?"":"asc"),u.sort==="asc"&&(x="desc"),u.sort=x},w=F(()=>p.reduce((f,h)=>(h.sort&&(h.sort==="asc"?f.push(h.field):f.push("-"+h.field)),f),[]));return(f,h)=>{const x=q("router-link");return l(),c(C,null,[Ki,s(i(nt),{"ds-data":i(a),"ds-sortby":i(w)},{default:z(({ds:u})=>[t("div",{class:"row","data-page-count":u.dsPagecount},[t("div",Vi,[s(i(tt),{"ds-show-entries":"25"})]),t("div",Yi,[s(i(et),{"ds-search-placeholder":"Search..."})])],8,Hi),t("div",Fi,[t("div",Wi,[t("div",Ji,[t("table",Zi,[t("thead",null,[t("tr",null,[(l(!0),c(C,null,A(p,(d,g)=>(l(),c("th",{key:d.field,class:W(["sort",d.sort]),onClick:v=>b(v,g)},[y(k(d.name)+" ",1),Xi],10,Gi))),128)),tn])]),s(i(ot),{tag:"tbody"},{default:z(({row:d})=>[t("tr",null,[t("td",null,k(d.queue_name),1),t("td",null,k(d.periods),1),t("td",null,k(d.recent),1),t("td",null,[s(x,{to:{name:"data_periods",params:{name:d.queue_name}},class:"btn btn-secondary btn-sm mx-1"},{default:z(()=>[en]),_:2},1032,["to"])])])]),_:1})])])])]),t("div",on,[s(i(rt),{class:"mb-2 mb-md-0"}),s(i(it))])]),_:1},8,["ds-data","ds-sortby"])],64)}}},nn={__name:"DashboardView",setup(e){return(o,r)=>(l(),j(rn))}};const an={class:"display-5 text-center"},ln=["data-page-count"],sn={class:"col-md-6 mb-2 mb-md-0"},dn={class:"col-md-6"},mn={class:"row"},cn={class:"col-md-12"},pn={class:"table-responsive"},gn={class:"table table-striped d-md-table"},bn=["onClick"],un=t("i",{class:"gg-select float-right"},null,-1),fn=t("th",null,"Actions",-1),hn=y("View"),xn={class:"d-flex flex-md-row flex-column justify-content-between align-items-center"},wn={__name:"PeriodList",props:{name:{type:String,default:""}},async setup(e){let o,r;const n=e,a=pt();[o,r]=Q(()=>a.loadPeriods(n.name)),await o,r();const{periods:p}=S(a),b=P([{name:"ID",field:"id",sort:""},{name:"Opened",field:"created_at",sort:""},{name:"Closed",field:"updated_at",sort:""},{name:"Events",field:"events",sort:""}]),w=function(h,x){let u;const d=b[x];h.shiftKey||this.cols.forEach(g=>{g.field!==d.field&&(g.sort="")}),d.sort||(u="asc"),d.sort==="desc"&&(u=h.shiftKey?"":"asc"),d.sort==="asc"&&(u="desc"),d.sort=u},f=F(()=>b.reduce((h,x)=>(x.sort&&(x.sort==="asc"?h.push(x.field):h.push("-"+x.field)),h),[]));return(h,x)=>{const u=q("router-link");return l(),c(C,null,[t("h1",an,"Event Log: "+k(e.name),1),s(i(nt),{"ds-data":i(p),"ds-sortby":i(f)},{default:z(({ds:d})=>[t("div",{class:"row","data-page-count":d.dsPagecount},[t("div",sn,[s(i(tt),{"ds-show-entries":"25"})]),t("div",dn,[s(i(et),{"ds-search-placeholder":"Search..."})])],8,ln),t("div",mn,[t("div",cn,[t("div",pn,[t("table",gn,[t("thead",null,[t("tr",null,[(l(!0),c(C,null,A(b,(g,v)=>(l(),c("th",{key:g.field,class:W(["sort",g.sort]),onClick:$=>w($,v)},[y(k(g.name)+" ",1),un],10,bn))),128)),fn])]),s(i(ot),{tag:"tbody"},{default:z(({row:g})=>[t("tr",null,[t("td",null,k(g.id),1),t("td",null,k(g.created_at),1),t("td",null,k(g.updated_at),1),t("td",null,k(g.events),1),t("td",null,[s(u,{to:{name:"period",params:{id:g.id}},class:"btn btn-secondary btn-sm mx-1"},{default:z(()=>[hn]),_:2},1032,["to"])])])]),_:1})])])])]),t("div",xn,[s(i(rt),{class:"mb-2 mb-md-0"}),s(i(it))])]),_:1},8,["ds-data","ds-sortby"])],64)}}},vn={__name:"PeriodView",setup(e){return(o,r)=>(l(),j(wn))}},kn={class:"display-5 text-center"},yn=t("h2",{class:"text-center"},"Events",-1),_n=["data-page-count"],zn={class:"col-md-6 mb-2 mb-md-0"},$n={class:"col-md-6"},Cn={class:"row"},qn={class:"col-md-12"},Mn={class:"table-responsive"},jn={class:"table table-striped d-md-table"},Sn=["onClick"],En=t("i",{class:"gg-select float-right"},null,-1),Qn={class:"d-flex flex-md-row flex-column justify-content-between align-items-center"},Ln=t("h2",{class:"text-center"},"Presences",-1),In=["data-page-count"],An={class:"col-md-6 mb-2 mb-md-0"},Bn={class:"col-md-6"},Dn={class:"row"},Rn={class:"col-md-12"},Tn={class:"table-responsive"},Pn={class:"table table-striped d-md-table"},On=["onClick"],Nn=t("i",{class:"gg-select float-right"},null,-1),Un={class:"d-flex flex-md-row flex-column justify-content-between align-items-center"},Kn={__name:"EventList",props:{id:{type:Number,default:-1}},async setup(e){let o,r;const n=e,a=pt();[o,r]=Q(()=>a.loadEvents(n.id)),await o,r();const{events:p,presences:b}=S(a),w=P([{name:"ID",field:"id",sort:""},{name:"eID",field:"eid",sort:""},{name:"Status",field:"status",sort:""},{name:"Start",field:"created_at",sort:""},{name:"End",field:"updated_at",sort:""},{name:"Helper",field:"presence.eid",sort:""}]),f=P([{name:"ID",field:"id",sort:""},{name:"eID",field:"eid",sort:""},{name:"Start",field:"created_at",sort:""},{name:"End",field:"updated_at",sort:""}]),h=function(g,v){let $;const _=w[v];g.shiftKey||this.eventCols.forEach(E=>{E.field!==_.field&&(E.sort="")}),_.sort||($="asc"),_.sort==="desc"&&($=g.shiftKey?"":"asc"),_.sort==="asc"&&($="desc"),_.sort=$},x=function(g,v){let $;const _=f[v];g.shiftKey||this.presenceCols.forEach(E=>{E.field!==_.field&&(E.sort="")}),_.sort||($="asc"),_.sort==="desc"&&($=g.shiftKey?"":"asc"),_.sort==="asc"&&($="desc"),_.sort=$},u=F(()=>w.reduce((g,v)=>(v.sort&&(v.sort==="asc"?g.push(v.field):g.push("-"+v.field)),g),[])),d=F(()=>f.reduce((g,v)=>(v.sort&&(v.sort==="asc"?g.push(v.field):g.push("-"+v.field)),g),[]));return(g,v)=>(l(),c(C,null,[t("h1",kn,"Event Log: Period "+k(e.id),1),yn,s(i(nt),{"ds-data":i(p),"ds-sortby":i(u)},{default:z(({ds:$})=>[t("div",{class:"row","data-page-count":$.dsPagecount},[t("div",zn,[s(i(tt),{"ds-show-entries":"25"})]),t("div",$n,[s(i(et),{"ds-search-placeholder":"Search..."})])],8,_n),t("div",Cn,[t("div",qn,[t("div",Mn,[t("table",jn,[t("thead",null,[t("tr",null,[(l(!0),c(C,null,A(w,(_,E)=>(l(),c("th",{key:_.field,class:W(["sort",_.sort]),onClick:Z=>h(Z,E)},[y(k(_.name)+" ",1),En],10,Sn))),128))])]),s(i(ot),{tag:"tbody"},{default:z(({row:_})=>[t("tr",null,[t("td",null,k(_.id),1),t("td",null,k(_.eid),1),t("td",null,k(_.status),1),t("td",null,k(_.created_at),1),t("td",null,k(_.updated_at),1),t("td",null,k(_.presence?_.presence.eid:""),1)])]),_:1})])])])]),t("div",Qn,[s(i(rt),{class:"mb-2 mb-md-0"}),s(i(it))])]),_:1},8,["ds-data","ds-sortby"]),Ln,s(i(nt),{"ds-data":i(b),"ds-sortby":i(d)},{default:z(({ds:$})=>[t("div",{class:"row","data-page-count":$.dsPagecount},[t("div",An,[s(i(tt),{"ds-show-entries":"25"})]),t("div",Bn,[s(i(et),{"ds-search-placeholder":"Search..."})])],8,In),t("div",Dn,[t("div",Rn,[t("div",Tn,[t("table",Pn,[t("thead",null,[t("tr",null,[(l(!0),c(C,null,A(f,(_,E)=>(l(),c("th",{key:_.field,class:W(["sort",_.sort]),onClick:Z=>x(Z,E)},[y(k(_.name)+" ",1),Nn],10,On))),128))])]),s(i(ot),{tag:"tbody"},{default:z(({row:_})=>[t("tr",null,[t("td",null,k(_.id),1),t("td",null,k(_.eid),1),t("td",null,k(_.created_at),1),t("td",null,k(_.updated_at),1)])]),_:1})])])])]),t("div",Un,[s(i(rt),{class:"mb-2 mb-md-0"}),s(i(it))])]),_:1},8,["ds-data","ds-sortby"])],64))}},Hn={__name:"EventView",setup(e){return(o,r)=>(l(),j(Kn))}},U=()=>L().is_admin,yt=qt({history:Mt("/"),routes:[{path:"/",name:"home",component:ro},{path:"/about",name:"about",component:()=>Ue(()=>import("./AboutView.20146c59.js"),["assets/AboutView.20146c59.js","assets/vendor.0627cd51.js"])},{path:"/queues",name:"queues",component:_o},{path:"/queues/:id",name:"queue_single",component:jr,props:e=>({id:Number(e.params.id)})},{path:"/queues/:id/edit",name:"queue_edit",component:Or,props:!0,beforeEnter:U},{path:"/profile",name:"profile",component:Jr},{path:"/admin",name:"admin",component:Ei,beforeEnter:U},{path:"/admin/user/:id/edit",name:"admin_useredit",component:Ui,props:!0,beforeEnter:U},{path:"/data",name:"data",component:nn,beforeEnter:U},{path:"/data/:name",name:"data_periods",component:vn,beforeEnter:U,props:e=>({name:e.params.name})},{path:"/period/:id",name:"period",component:Hn,beforeEnter:U,props:e=>({id:e.params.id})}]});yt.beforeEach(async function(e){if(e.name!=="home"&&e.name!=="about"){const o=L();if(o.token||await o.tryToken(),!o.token)return"/"}});const Vn=()=>{M.interceptors.request.use(e=>{if(e.url!=="/auth/token"){const o=L();o.token&&(e.headers.Authorization="Bearer "+o.token)}return e},e=>Promise.reject(e)),M.interceptors.response.use(e=>e,async e=>{const o=e.config;if(o.url!=="/auth/token"&&e.response&&e.response.status===401&&!o._retry){o._retry=!0;try{return await L().refreshToken(),M(o)}catch(r){return Promise.reject(r)}}return Promise.reject(e)})};m.useDefaults();m.setLevel(m.WARN);jt.add(St,Et,Qt,Lt,It,At,Bt,Dt,Rt,Tt,Pt,Ot,Nt,Ut,Kt,Ht,Vt,Yt,Ft,Wt,Jt,Zt,Gt,Xt,te,ee,oe);re.watch();Vn();const N=ie(Pe);N.use(ne());N.use(yt);N.use(ae,bt);N.use(le,se({config:{classes:{input:"form-control",label:"form-label",help:"form-text",outer:"mb-3"}}}));N.use(de);N.component("FontAwesomeIcon",me);N.mount("#app");export{T as _};
